{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6**","webpack:///webpack/bootstrap eb18d2e0a7c01ed7e320?e7ee**","webpack:///./threenodes/UI.coffee","webpack:///external \"_\"?b3b9**","webpack:///external \"Backbone\"?709d**","webpack:///./threenodes/nodes/models/Node.coffee?4363**","webpack:///./threenodes/utils/Utils.coffee?8c75**","webpack:///./threenodes/nodes/templates/node.tmpl.html?b6e1","webpack:///./threenodes/nodes/templates/node_context_menu.tmpl.html?2243","webpack:///./libs/namespace.js?c027","webpack:///./libs/jquery.contextMenu.js?77a1","webpack:///external \"jQuery\"?0cb8*","webpack:///./threenodes/nodes/views/NodeView.coffee?ca32","webpack:///./threenodes/fields/views/FieldsView.coffee?eefa","webpack:///./threenodes/fields/views/FieldButton.coffee?52b5","webpack:///./threenodes/fields/templates/node_field_input.tmpl.html?c6e9","webpack:///./threenodes/fields/templates/node_field_output.tmpl.html?5ba3","webpack:///./threenodes/fields/templates/field_context_menu.tmpl.html?a491","webpack:///./threenodes/nodes/views/Color.coffee?ff3a","webpack:///./libs/colorpicker/js/colorpicker.js?3e0b","webpack:///external \"Blob\"?4eae","webpack:///external \"FileSaver\"?c02a","webpack:///./threenodes/views/UIView.coffee","webpack:///./templates/app_ui.tmpl.html","webpack:///./threenodes/views/sidebar/Sidebar.coffee","webpack:///./threenodes/views/sidebar/NodeSidebarView.coffee","webpack:///./threenodes/views/TreeView.coffee","webpack:///./threenodes/views/Breadcrumb.coffee","webpack:///./threenodes/views/MenuBar.coffee","webpack:///./templates/app_menubar.tmpl.html","webpack:///./libs/jquery.menubar.js","webpack:///./libs/three-extras/js/RequestAnimationFrame.js","webpack:///external \"Raphael\"","webpack:///./libs/jquery.transform2d.js","webpack:///./libs/jquery-scrollview/jquery.scrollview.js","webpack:///./threenodes/views/Workspace.coffee","webpack:///./threenodes/connections/views/ConnectionView.coffee","webpack:///./threenodes/groups/views/Group.coffee","webpack:///./threenodes/groups/templates/group_context_menu.tmpl.html","webpack:///./threenodes/views/AppTimeline.coffee","webpack:///./threenodes/utils/UrlHandler.coffee","webpack:///./threenodes/utils/FileHandler.coffee","webpack:///./threenodes/utils/CodeExporter.coffee","webpack:///./threenodes/nodes/views/WebGLRenderer.coffee"],"names":[],"mappings":"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CA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAsC,WAAW;AACjD;AACA,gEAA+D;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,EAAC;;;;;;;AC5BD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAoB,kBAAkB;AACtC;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA,SAAQ;;AAER;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;;AAER;AACA;AACA;AACA;AACA;AACA;AACA,kFAAiF,wDAAwD;AACzI;AACA,SAAQ;;AAER;AACA,gCAA+B;AAC/B;AACA;AACA;AACA;AACA,UAAS;AACT,SAAQ;AACR;AACA,OAAM;AACN,MAAK;;AAEL;AACA;AACA,wCAAuC,cAAc,2BAA2B,EAAE,EAAE;AACpF,MAAK;AACL,wCAAuC,2DAA2D,cAAc,EAAE,EAAE,EAAE;AACtH,MAAK,OAAO;AACZ,uCAAsC,yDAAyD,cAAc,EAAE,EAAE,EAAE;AACnH;AACA;AACA,oEAAmE,cAAc,EAAE;;AAEnF,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,cAAc;AAClC;;AAEA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;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AAQ;KACN,IAAC,WAAU,CAAC,IAAZ,CAAiB;AACf;OAAA,IAAG,EAAE,IAAF,CAAO,CAAC,IAAR,CAAa,eAAb,CAAH;SACE,MAAM,EAAE,MAAM,EAAE,IAAF,CAAO,CAAC,IAAR,CAAa,eAAb,CAAR;SACN,SAAS,GAAG,CAAC,IAAJ,CAAS,aAAT;SACT,IAAG,MAAH;WACE,OAAO,MAAM,CAAC,SADhB;;gBAGA,GAAG,CAAC,MAAJ,GANF;;KADe,CAAjB;KAQA,IAAC,WAAU,CAAC,MAAZ;KACA,IAAC,WAAU,CAAC,MAAZ;KACA,OAAO,IAAC;YACR;GAZM;;;;IA1BU;;AAwCpB,OAAM,CAAC,OAAP,GAAiB;;;;;;;AChDjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B;AAC1B,+BAA8B;AAC9B,2BAA0B;AAC1B,6BAA4B;AAC5B,6BAA4B;AAC5B;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA,gFAA+E,yBAAyB;AACxG;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,OAAM;AACN,MAAK;AACL;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,mCAAmC;AAChD;AACA;AACA;AACA,oCAAmC,SAAS;AAC5C;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,mBAAkB,OAAO;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,aAAY;AACZ,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,OAAM;AACN;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,gBAAe,SAAS,UAAU;AAClC,sBAAqB,SAAS,UAAU;AACxC,sBAAqB,SAAS,UAAU;AACxC,sBAAqB,SAAS,UAAU;AACxC,sBAAqB,SAAS,UAAU;AACxC,sBAAqB,SAAS,UAAU;AACxC,YAAW,QAAQ,SAAS;AAC5B;AACA,aAAY;AACZ,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,mBAAmB;AACxC;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,gCAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR,QAAO;AACP;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,GAAE;AACF;AACA;AACA;AACA;AACA;AACA,GAAE;AACF,EAAC,S;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpeD,iD;;;;;;ACAA,iD;;;;;;;;;;;;;;;ACAA;AAAA;GAAA;;;;AACA,KAAI,oBAAQ,CAAR;;AACJ,YAAW,oBAAQ,CAAR;;AACX,gBAAe,oBAAQ,EAAR;;AACf,WAAU,oBAAQ,EAAR;;AACV,cAAa,oBAAQ,EAAR;;A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K;AACL,IAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAW;AACX;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,IAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAK;AACL,IAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA,EAAC;;AAED,EAAC;;;;;;;ACjeD;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,GAAE;;AAEF;;;;;;;ACrBA,kD;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4EAA2E,EAAE;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,uCAAsC,EAAE;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF,EAAC;AACD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,yBAAwB,QAAQ;;AAEhC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAE;AACF;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,EAAC;;;;;;;ACtiBD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAC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","file":"ThreeNodes.UI.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"_\"), require(\"Backbone\"), require(\"jQuery\"), require(\"Blob\"), require(\"FileSaver\"), require(\"Raphael\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"_\", \"Backbone\", \"jQuery\", \"Blob\", \"FileSaver\", \"Raphael\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"UI\"] = factory(require(\"_\"), require(\"Backbone\"), require(\"jQuery\"), require(\"Blob\"), require(\"FileSaver\"), require(\"Raphael\"));\n\telse\n\t\troot[\"ThreeNodes\"] = root[\"ThreeNodes\"] || {}, root[\"ThreeNodes\"][\"UI\"] = factory(root[\"_\"], root[\"Backbone\"], root[\"jQuery\"], root[\"Blob\"], root[\"FileSaver\"], root[\"Raphael\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_3__, __WEBPACK_EXTERNAL_MODULE_17__, __WEBPACK_EXTERNAL_MODULE_80__, __WEBPACK_EXTERNAL_MODULE_81__, __WEBPACK_EXTERNAL_MODULE_100__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"assets/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap eb18d2e0a7c01ed7e320","require 'jquery'\n_ = require 'Underscore'\nBackbone = require 'Backbone'\nUIView = require './views/UIView'\nWorkspace = require './views/Workspace'\nAppTimeline = require './views/AppTimeline'\n# GroupDefinitionView = require './views/GroupDefinitionView'\n#WebglBase = require 'threenodes/utils/WebglBase'\nUrlHandler = require 'threenodes/utils/UrlHandler'\nFileHandler = require 'threenodes/utils/FileHandler'\n\nNodeView = require 'threenodes/nodes/views/NodeView'\nNodeViewColor = require 'threenodes/nodes/views/Color'\nNodeViewWebgl = require 'threenodes/nodes/views/WebGLRenderer'\n# NodeViewGroup = require 'threenodes/nodes/views/Group'\n\nclass UI\n  constructor: (@core) ->\n    # Fix backbone with webpack.\n    Backbone.$ = $\n\n    # Define renderer mouseX/Y for use in utils.Mouse node for instance\n    ThreeNodes.renderer =\n      mouseX: 0\n      mouseY: 0\n\n    #@webgl = new WebglBase()\n\n    @url_handler = new UrlHandler()\n    @file_handler = new FileHandler(@core)\n\n    # File and url events\n    @file_handler.on(\"ClearWorkspace\", () => @clearWorkspace())\n    @url_handler.on(\"ClearWorkspace\", () => @clearWorkspace())\n    @url_handler.on(\"LoadJSON\", @file_handler.loadFromJsonData)\n\n    # Initialize the user interface and timeline\n    @initUI()\n    @initTimeline()\n\n    # Initialize the workspace view\n    @createWorkspace()\n    # Make the workspace display the global nodes and connections\n    @workspace.render(@core.nodes, @core.connections, @core.groups)\n\n    # Start the url handling\n    #\n    # Enabling the pushState method would require to redirect path\n    # for the node.js server and github page (if possible)\n    # for simplicity we disable it\n    Backbone.history.start\n      pushState: false\n\n    return true\n\n  createWorkspace: () =>\n    if @workspace then @workspace.destroy()\n    @workspace = new Workspace\n      el: jQuery(\"<div class='nodes-container'></div>\").appendTo(\"#container\")\n      settings: @core.settings\n\n  setWorkspaceFromDefinition: (definition) =>\n    @createWorkspace()\n\n    # always remove current edit node if it exists\n    if @edit_node\n      console.log \"remove edit node\"\n      @edit_node.remove()\n      delete @edit_node\n      # maybe sync new modifications...\n\n    if definition == \"global\"\n      @workspace.render(@core.nodes)\n      @ui.breadcrumb.reset()\n    else\n      # create a hidden temporary group node from this definition\n      # @edit_node = @core.nodes.createGroup\n      #   type: \"Group\"\n      #   definition: definition\n      #   x: -9999\n      # @workspace.render(@edit_node.nodes)\n      # @ui.breadcrumb.set([definition])\n\n  initUI: () =>\n    if @core.settings.test == false\n      # Create the main user interface view\n      @ui = new UIView\n        el: $(\"body\")\n        settings: @core.settings\n\n      # Link UI to render events\n      @ui.on(\"render\", @core.nodes.render)\n      @ui.on(\"renderConnections\", @core.nodes.renderAllConnections)\n\n      # Setup the main menu events\n      @ui.menubar.on(\"RemoveSelectedNodes\", @core.nodes.removeSelectedNodes)\n      @ui.menubar.on(\"ClearWorkspace\", @clearWorkspace)\n      @ui.menubar.on(\"SaveFile\", @file_handler.saveLocalFile)\n      @ui.menubar.on(\"ExportCode\", @file_handler.exportCode)\n      @ui.menubar.on(\"LoadJSON\", @file_handler.loadFromJsonData)\n      @ui.menubar.on(\"LoadFile\", @file_handler.loadLocalFile)\n      #@ui.menubar.on(\"ExportImage\", @webgl.exportImage)\n      # @ui.menubar.on(\"GroupSelectedNodes\", @core.group_definitions.groupSelectedNodes)\n      @ui.menubar.on(\"GroupSelectedNodes\", @core.createGroup.bind(@core))\n\n      # Special events\n      @url_handler.on(\"SetDisplayModeCommand\", @ui.setDisplayMode)\n\n      #breadcrumb\n      @ui.breadcrumb.on(\"click\", @setWorkspaceFromDefinition)\n    else\n      # If the application is in test mode add a css class to the body\n      $(\"body\").addClass \"test-mode\"\n    return this\n\n  setDisplayMode: (is_player = false) =>\n    if @ui then @ui.setDisplayMode(is_player)\n\n  initTimeline: () =>\n    # Remove old timeline DOM elements\n    $(\"#timeline-container, #keyEditDialog\").remove()\n\n    # Cleanup the old timeline if there was one\n    if @timelineView\n      @core.nodes.off(\"remove\", @timelineView.onNodeRemove)\n      @timelineView.remove()\n      if @ui\n        @timelineView.off(\"TimelineCreated\", @ui.onUiWindowResize)\n\n    # Create a new timeline\n    @timelineView = new AppTimeline\n      el: $(\"#timeline\")\n      ui: @ui\n\n    # Bind events to it\n    # @core.nodes.bindTimelineEvents(@timelineView)\n    @core.nodes.on(\"remove\", @timelineView.onNodeRemove)\n    if @ui then @ui.onUiWindowResize()\n\n    return this\n\n  clearWorkspace: () =>\n    # @core.nodes.clearWorkspace()\n    # @core.group_definitions.removeAll()\n    # if @ui then @ui.clearWorkspace()\n    #@initTimeline()\n\nUI.nodes = {}\nUI.UIView = UIView\nUI.nodes.NodeView = NodeView\nUI.nodes.Color = NodeViewColor\nUI.nodes.WebGLRenderer = NodeViewWebgl\n# UI.nodes.Group = NodeViewGroup\n\nmodule.exports = UI\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/UI.coffee","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"_\"\n// module id = 2\n// module chunks = 0 1 2 3","module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Backbone\"\n// module id = 3\n// module chunks = 0 1 2 3","_ = require 'Underscore'\nBackbone = require 'Backbone'\nUtils = require 'threenodes/utils/Utils'\n\nclass Node extends Backbone.Model\n  defaults:\n    x: 0\n    y: 0\n    width: 90\n    height: 26\n    name: \"\"\n\n  initialize: (obj) =>\n    super\n    \n    id = obj.id || indexer.getUID() #todo: Indexer\n    @set('id', id)\n    \n    name = obj.name || @typename()\n    @set('name', name)\n\n    @set('x', obj.x)\n    @set('y', obj.y)\n    @set('width', obj.width)\n    @set('height', obj.height)\n    return this\n\n  typename: => String(@constructor.name)\n\n  toJSON: () =>\n    res =\n      id: @get('id')\n      type: @typename()\n      x: @get('x')\n      y: @get('y')\n      width: @get('width')\n      height: @get('height')\n    res\n\n\n  remove: () =>\n    @trigger \"node:removed\", @\n \nmodule.exports = Node\n\n\n// WEBPACK FOOTER //\n// ./threenodes/nodes/models/Node.coffee","class Utils\n  @flatArraysAreEquals: (arr1, arr2) ->\n    if arr1.length != arr2.length\n      return false\n\n    for k, i in arr1\n      if arr1[i] != arr2[i]\n        return false\n\n    true\n\nmodule.exports = Utils\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/utils/Utils.coffee","module.exports = \"<div class='head'><span><%= get(\\\"name\\\") %></span></div>\\n<div class='options'>\\n  <div class='inputs'></div>\\n  <div class='center'></div>\\n  <div class='outputs'></div>\\n</div>\\n\\n<div class=\\\"up handler\\\" data-attr='up'></div>\\n<div class=\\\"down handler\\\" data-attr='down'></div>\\n<div class=\\\"left handler\\\" data-attr='left'></div>\\n<div class=\\\"right handler\\\" data-attr='right'></div>\\n\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./threenodes/nodes/templates/node.tmpl.html\n// module id = 13\n// module chunks = 1 3","module.exports = \"<ul id=\\\"node-context-menu\\\" class=\\\"context-menu\\\">\\n  <li><a href=\\\"#remove_node\\\">Remove node</a></li>\\n</ul>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./threenodes/nodes/templates/node_context_menu.tmpl.html\n// module id = 14\n// module chunks = 1 3","/*\n * namespace.coffee v1.0.0\n * Copyright (c) 2011 CodeCatalyst, LLC.\n * Open source under the MIT License.\n */\n(function() {\n  var namespace;\n  namespace = function(name, values) {\n    var key, subpackage, target, value, _i, _len, _ref, _results;\n    target = typeof exports !== \"undefined\" && exports !== null ? exports : window;\n    //target = window;\n    if (name.length > 0) {\n      _ref = name.split('.');\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        subpackage = _ref[_i];\n        target = target[subpackage] || (target[subpackage] = {});\n      }\n    }\n    _results = [];\n    for (key in values) {\n      value = values[key];\n      _results.push(target[key] = value);\n    }\n    return _results;\n  };\n  namespace(\"\", {\n    namespace: namespace\n  });\n}).call(this);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./libs/namespace.js\n// module id = 15\n// module chunks = 1 3","// jQuery Context Menu Plugin\r\n//\r\n// Version 1.01\r\n//\r\n// Cory S.N. LaViska\r\n// A Beautiful Site (http://abeautifulsite.net/)\r\n//\r\n// More info: http://abeautifulsite.net/2008/09/jquery-context-menu-plugin/\r\n//\r\n// Terms of Use\r\n//\r\n// This plugin is dual-licensed under the GNU General Public License\r\n//   and the MIT License and is copyright A Beautiful Site, LLC.\r\n//\r\nif(jQuery)( function() {\r\n\t$.extend($.fn, {\r\n\r\n\t\tcontextMenu: function(o, callback) {\r\n\t\t\t// Defaults\r\n\t\t\tif( o.menu == undefined ) return false;\r\n\t\t\tif( o.inSpeed == undefined ) o.inSpeed = 150;\r\n\t\t\tif( o.outSpeed == undefined ) o.outSpeed = 75;\r\n\t\t\t// 0 needs to be -1 for expected results (no fade)\r\n\t\t\tif( o.inSpeed == 0 ) o.inSpeed = -1;\r\n\t\t\tif( o.outSpeed == 0 ) o.outSpeed = -1;\r\n\t\t\t// Loop each context menu\r\n\t\t\t$(this).each( function() {\r\n\t\t\t\tvar el = $(this);\r\n\t\t\t\tvar offset = $(el).offset();\r\n\t\t\t\t// Add contextMenu class\r\n\t\t\t\t$('#' + o.menu).addClass('contextMenu');\r\n\t\t\t\t// Simulate a true right click\r\n\t\t\t\t$(this).mousedown( function(e) {\r\n\t\t\t\t\tvar evt = e;\r\n\t\t\t\t\tevt.preventDefault();\r\n\t\t\t\t\t$(this).mouseup( function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tvar srcElement = $(this);\r\n\t\t\t\t\t\t$(this).unbind('mouseup');\r\n\t\t\t\t\t\tif( evt.button == 2 ) {\r\n\t\t\t\t\t\t\t// Hide context menus that may be showing\r\n\t\t\t\t\t\t\t$(\".contextMenu\").hide();\r\n\t\t\t\t\t\t\t// Get this context menu\r\n\t\t\t\t\t\t\tvar menu = $('#' + o.menu);\r\n\r\n\t\t\t\t\t\t\tif( $(el).hasClass('disabled') ) return false;\r\n\r\n\t\t\t\t\t\t\t// Detect mouse position\r\n\t\t\t\t\t\t\tvar d = {}, x, y;\r\n\t\t\t\t\t\t\tif( self.innerHeight ) {\r\n\t\t\t\t\t\t\t\td.pageYOffset = self.pageYOffset;\r\n\t\t\t\t\t\t\t\td.pageXOffset = self.pageXOffset;\r\n\t\t\t\t\t\t\t\td.innerHeight = self.innerHeight;\r\n\t\t\t\t\t\t\t\td.innerWidth = self.innerWidth;\r\n\t\t\t\t\t\t\t} else if( document.documentElement &&\r\n\t\t\t\t\t\t\t\tdocument.documentElement.clientHeight ) {\r\n\t\t\t\t\t\t\t\td.pageYOffset = document.documentElement.scrollTop;\r\n\t\t\t\t\t\t\t\td.pageXOffset = document.documentElement.scrollLeft;\r\n\t\t\t\t\t\t\t\td.innerHeight = document.documentElement.clientHeight;\r\n\t\t\t\t\t\t\t\td.innerWidth = document.documentElement.clientWidth;\r\n\t\t\t\t\t\t\t} else if( document.body ) {\r\n\t\t\t\t\t\t\t\td.pageYOffset = document.body.scrollTop;\r\n\t\t\t\t\t\t\t\td.pageXOffset = document.body.scrollLeft;\r\n\t\t\t\t\t\t\t\td.innerHeight = document.body.clientHeight;\r\n\t\t\t\t\t\t\t\td.innerWidth = document.body.clientWidth;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t(e.pageX) ? x = e.pageX : x = e.clientX + d.scrollLeft;\r\n\t\t\t\t\t\t\t(e.pageY) ? y = e.pageY : y = e.clientY + d.scrollTop;\r\n\r\n\t\t\t\t\t\t\t// Show the menu\r\n\t\t\t\t\t\t\t$(document).unbind('click');\r\n\t\t\t\t\t\t\t$(menu).css({ top: y, left: x }).fadeIn(o.inSpeed);\r\n\t\t\t\t\t\t\t// Hover events\r\n\t\t\t\t\t\t\t$(menu).find('A').mouseover( function() {\r\n\t\t\t\t\t\t\t\t$(menu).find('LI.hover').removeClass('hover');\r\n\t\t\t\t\t\t\t\t$(this).parent().addClass('hover');\r\n\t\t\t\t\t\t\t}).mouseout( function() {\r\n\t\t\t\t\t\t\t\t$(menu).find('LI.hover').removeClass('hover');\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t// Keyboard\r\n\t\t\t\t\t\t\t$(document).keypress( function(e) {\r\n\t\t\t\t\t\t\t\tswitch( e.keyCode ) {\r\n\t\t\t\t\t\t\t\t\tcase 38: // up\r\n\t\t\t\t\t\t\t\t\t\tif( $(menu).find('LI.hover').size() == 0 ) {\r\n\t\t\t\t\t\t\t\t\t\t\t$(menu).find('LI:last').addClass('hover');\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t$(menu).find('LI.hover').removeClass('hover').prevAll('LI:not(.disabled)').eq(0).addClass('hover');\r\n\t\t\t\t\t\t\t\t\t\t\tif( $(menu).find('LI.hover').size() == 0 ) $(menu).find('LI:last').addClass('hover');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tcase 40: // down\r\n\t\t\t\t\t\t\t\t\t\tif( $(menu).find('LI.hover').size() == 0 ) {\r\n\t\t\t\t\t\t\t\t\t\t\t$(menu).find('LI:first').addClass('hover');\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t$(menu).find('LI.hover').removeClass('hover').nextAll('LI:not(.disabled)').eq(0).addClass('hover');\r\n\t\t\t\t\t\t\t\t\t\t\tif( $(menu).find('LI.hover').size() == 0 ) $(menu).find('LI:first').addClass('hover');\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tcase 13: // enter\r\n\t\t\t\t\t\t\t\t\t\t$(menu).find('LI.hover A').trigger('click');\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tcase 27: // esc\r\n\t\t\t\t\t\t\t\t\t\t$(document).trigger('click');\r\n\t\t\t\t\t\t\t\t\tbreak\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t// When items are selected\r\n\t\t\t\t\t\t\t$('#' + o.menu).find('A').unbind('click');\r\n\t\t\t\t\t\t\t$('#' + o.menu).find('LI:not(.disabled) A').click( function() {\r\n\t\t\t\t\t\t\t\t$(document).unbind('click').unbind('keypress');\r\n\t\t\t\t\t\t\t\t$(\".contextMenu\").hide();\r\n\t\t\t\t\t\t\t\t// Callback\r\n\t\t\t\t\t\t\t\tif( callback ) callback( $(this).attr('href').substr(1), $(srcElement), {x: x - offset.left, y: y - offset.top, docX: x, docY: y} );\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t// Hide bindings\r\n\t\t\t\t\t\t\tsetTimeout( function() { // Delay for Mozilla\r\n\t\t\t\t\t\t\t\t$(document).click( function() {\r\n\t\t\t\t\t\t\t\t\t$(document).unbind('click').unbind('keypress');\r\n\t\t\t\t\t\t\t\t\t$(menu).fadeOut(o.outSpeed);\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}, 0);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Disable text selection\r\n\t\t\t\t/*if( $.browser.mozilla ) {\r\n\t\t\t\t\t$('#' + o.menu).each( function() { $(this).css({ 'MozUserSelect' : 'none' }); });\r\n\t\t\t\t} else if( $.browser.msie ) {\r\n\t\t\t\t\t$('#' + o.menu).each( function() { $(this).bind('selectstart.disableTextSelect', function() { return false; }); });\r\n\t\t\t\t} else {*/\r\n\t\t\t\t\t$('#' + o.menu).each(function() { $(this).bind('mousedown.disableTextSelect', function() { return false; }); });\r\n\t\t\t\t//}\r\n\t\t\t\t// Disable browser context menu (requires both selectors to work in IE/Safari + FF/Chrome)\r\n\t\t\t\t$(el).add($('UL.contextMenu')).bind('contextmenu', function() { return false; });\r\n\r\n\t\t\t});\r\n\t\t\treturn $(this);\r\n\t\t},\r\n\r\n\t\t// Disable context menu items on the fly\r\n\t\tdisableContextMenuItems: function(o) {\r\n\t\t\tif( o == undefined ) {\r\n\t\t\t\t// Disable all\r\n\t\t\t\t$(this).find('LI').addClass('disabled');\r\n\t\t\t\treturn( $(this) );\r\n\t\t\t}\r\n\t\t\t$(this).each( function() {\r\n\t\t\t\tif( o != undefined ) {\r\n\t\t\t\t\tvar d = o.split(',');\r\n\t\t\t\t\tfor( var i = 0; i < d.length; i++ ) {\r\n\t\t\t\t\t\t$(this).find('A[href=\"' + d[i] + '\"]').parent().addClass('disabled');\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn( $(this) );\r\n\t\t},\r\n\r\n\t\t// Enable context menu items on the fly\r\n\t\tenableContextMenuItems: function(o) {\r\n\t\t\tif( o == undefined ) {\r\n\t\t\t\t// Enable all\r\n\t\t\t\t$(this).find('LI.disabled').removeClass('disabled');\r\n\t\t\t\treturn( $(this) );\r\n\t\t\t}\r\n\t\t\t$(this).each( function() {\r\n\t\t\t\tif( o != undefined ) {\r\n\t\t\t\t\tvar d = o.split(',');\r\n\t\t\t\t\tfor( var i = 0; i < d.length; i++ ) {\r\n\t\t\t\t\t\t$(this).find('A[href=\"' + d[i] + '\"]').parent().removeClass('disabled');\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn( $(this) );\r\n\t\t},\r\n\r\n\t\t// Disable context menu(s)\r\n\t\tdisableContextMenu: function() {\r\n\t\t\t$(this).each( function() {\r\n\t\t\t\t$(this).addClass('disabled');\r\n\t\t\t});\r\n\t\t\treturn( $(this) );\r\n\t\t},\r\n\r\n\t\t// Enable context menu(s)\r\n\t\tenableContextMenu: function() {\r\n\t\t\t$(this).each( function() {\r\n\t\t\t\t$(this).removeClass('disabled');\r\n\t\t\t});\r\n\t\t\treturn( $(this) );\r\n\t\t},\r\n\r\n\t\t// Destroy context menu(s)\r\n\t\tdestroyContextMenu: function() {\r\n\t\t\t// Destroy specified context menus\r\n\t\t\t$(this).each( function() {\r\n\t\t\t\t// Disable action\r\n\t\t\t\t$(this).unbind('mousedown').unbind('mouseup');\r\n\t\t\t});\r\n\t\t\treturn( $(this) );\r\n\t\t}\r\n\r\n\t});\r\n})(jQuery);\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./libs/jquery.contextMenu.js\n// module id = 16\n// module chunks = 1 3","module.exports = __WEBPACK_EXTERNAL_MODULE_17__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jQuery\"\n// module id = 17\n// module chunks = 1 2 3","_ = require 'Underscore'\nBackbone = require 'Backbone'\n_view_node_template = require '../templates/node.tmpl.html'\n_view_node_context_menu = require '../templates/node_context_menu.tmpl.html'\nFieldsView = require 'threenodes/fields/views/FieldsView'\nnamespace = require('libs/namespace').namespace\n\nrequire 'libs/jquery.contextMenu'\nrequire 'jquery.ui'\n\n### Node View ###\nclass NodeView extends Backbone.View\n  className: \"node\"\n\n  initialize: (options) ->\n    @makeElement()\n    @makeDraggable()\n    @initNodeClick()\n    @initTitleClick()\n\n    # Initialize the fields view\n    # @fields_view = new FieldsView\n    #   node: @model\n    #   collection: @model.fields\n    #   el: $(\"> .options\", @$el)\n\n    # Bind events\n    @model.on('change', @render)\n    #@model.on('postInit', @postInit)\n    @model.on('remove', () => @remove())\n    @model.on(\"node:computePosition\", @computeNodePosition)\n    @model.on(\"node:renderConnections\", @renderConnections)\n    @model.on(\"node:addSelectedClass\", @addSelectedClass)\n\n    # Render the node and \"post init\" the model\n    @render()\n    @initContextMenus()\n    # @highlighAnimations()\n    #@model.postInit()\n\n  initContextMenus: () =>\n    if $(\"#node-context-menu\").length < 1\n      node_menu = _.template(_view_node_context_menu, {})\n      $(\"body\").append(node_menu)\n    @$el.find(\".head\").contextMenu {menu: \"node-context-menu\"}, (action, el, pos) =>\n      if action == \"remove_node\" then @model.remove()\n    return @\n\n  makeElement: () =>\n    # Compile the template file\n    @template = _.template(_view_node_template, @model)\n    @$el.html(@template)\n\n    # Add the node group name as a class to the node element for easier styling\n    @$el.addClass(\"type-\" + @model.constructor.group_name)\n\n    # Add other dynamic classes\n    @$el.addClass(\"node-\" + @model.typename())\n\n  render: () =>\n    @$el.css\n      left: parseInt @model.get(\"x\")\n      top: parseInt @model.get(\"y\")\n    @$el.find(\"> .head span\").text(@model.get(\"name\"))\n    @$el.find(\"> .head span\").show()\n\n  highlighAnimations: () =>\n    nodeAnimation = false\n    for propTrack in @model.anim.objectTrack.propertyTracks\n      $target = $('.inputs .field-' + propTrack.name , @$el)\n      if propTrack.anims.length > 0\n        $target.addClass \"has-animation\"\n        nodeAnimation = true\n      else\n        $target.removeClass \"has-animation\"\n\n    @$el.toggleClass \"node-has-animation\", nodeAnimation\n    true\n\n  addSelectedClass: () =>\n    @$el.addClass(\"ui-selected\")\n\n  renderConnections: () =>\n    @model.renderConnections()\n    # @model.fields.renderConnections()\n    # if @model.nodes\n    #   _.each @model.nodes.models, (n) ->\n    #     n.fields.renderConnections()\n\n  computeNodePosition: () =>\n    pos = $(@el).position()\n    offset = $(\"#container-wrapper\").offset()\n    @model.set\n      x: pos.left + $(\"#container-wrapper\").scrollLeft()\n      y: pos.top + $(\"#container-wrapper\").scrollTop()\n\n  remove: () =>\n    $(\".field\", this.el).destroyContextMenu()\n    if @$el.data(\"draggable\") then @$el.draggable(\"destroy\")\n    $(this.el).unbind()\n    @undelegateEvents()\n    if @fields_view then @fields_view.remove()\n    delete @fields_view\n    super\n\n  initNodeClick: () ->\n    self = this\n    $(@el).click (e) ->\n      if e.metaKey == false\n        $( \".node\" ).removeClass(\"ui-selected\")\n        $(this).addClass(\"ui-selecting\")\n      else\n        if $(this).hasClass(\"ui-selected\")\n          $(this).removeClass(\"ui-selected\")\n        else\n          $(this).addClass(\"ui-selecting\")\n      selectable = $(\"#container\").data(\"ui-selectable\")\n      if !selectable then return\n      selectable.refresh()\n      selectable._mouseStop(null)\n      self.model.fields.renderSidebar()\n    return @\n\n  initTitleClick: () ->\n    self = this\n\n    $title_span = @$el.find(\"> .head span\")\n    $input = $(\"<input type='text' />\")\n    @$el.find(\"> .head\").append($input)\n    $input.hide()\n\n    # Fix conflict with contextmenu.\n    $input.on 'mousedown', (e) ->\n      e.stopPropagation()\n\n    $title_span.dblclick (e) ->\n      prev = $(this).html()\n      $input.val(prev)\n      $title_span.hide();\n      $input.show()\n\n      apply_input_result = () ->\n        self.model.set('name', $input.val())\n        $input.hide()\n        $title_span.show()\n\n      $input.blur (e) ->\n        apply_input_result()\n\n      $(\"#graph\").click (e) ->\n        apply_input_result()\n\n      $input.keydown (e) ->\n        # on enter\n        if e.keyCode == 13\n          apply_input_result()\n    return @\n\n  makeDraggable: () =>\n    self = this\n\n    nodes_offset = {top: 0, left: 0}\n    selected_nodes = $([])\n\n    $(this.el).draggable\n      start: (ev, ui) ->\n        if $(this).hasClass(\"ui-selected\")\n          selected_nodes = $(\".ui-selected\").each () ->\n            $(this).data(\"offset\", $(this).offset())\n        else\n          selected_nodes = $([])\n          $(\".node\").removeClass(\"ui-selected\")\n        nodes_offset = $(this).offset()\n      drag: (ev, ui) ->\n\n        dt = ui.position.top - nodes_offset.top\n        dl = ui.position.left - nodes_offset.left\n        selected_nodes.not(this).each () ->\n          el = $(this)\n          offset = el.data(\"offset\")\n          dx = offset.top + dt\n          dy = offset.left + dl\n          el.css\n            top: dx\n            left: dy\n          el.data(\"object\").trigger(\"node:computePosition\")\n          el.data(\"object\").trigger(\"node:renderConnections\")\n\n        self.renderConnections()\n      stop: () ->\n        selected_nodes.not(this).each () ->\n          el = $(this).data(\"object\")\n          el.trigger(\"node:renderConnections\")\n        self.computeNodePosition()\n        self.renderConnections()\n    return @\n\nThreeNodes.Core.addNodeView('NodeView', NodeView)\n\nmodule.exports = NodeView\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/nodes/views/NodeView.coffee","_ = require 'Underscore'\nBackbone = require 'Backbone'\nFieldButton = require './FieldButton'\n\nrequire 'jquery.ui'\n\n### Fields View ###\nclass FieldsView extends Backbone.View\n  # Save some options in variables and bind events\n  initialize: (options) ->\n    super\n    @node = options.node\n    @subviews = []\n    @collection.on(\"add\", @onFieldCreated)\n\n    # create already existing fields\n    @collection.each(@onFieldCreated)\n\n  # Create the field dom element and add events to it\n  onFieldCreated: (field) =>\n    target = if field.get(\"is_output\") == false then \".inputs\" else \".outputs\"\n    # Don't show input field from subnode if it has an internal connection\n    if field.get(\"is_output\") == false && field.isConnected()\n      connection = field.connections[0]\n      # But we want to display the field if we are editing the Group definition\n      $node = @$el.parent()\n      isInsideAnotherDOMnode = () -> ($node.parent().closest(\".node\").length > 0)\n\n      if isInsideAnotherDOMnode()\n        # if from_field node and to_field node have a gid != -1 and are identical\n        from_gid = connection.from_field.node.get(\"gid\")\n        to_gid = connection.to_field.node.get(\"gid\")\n        if from_gid != \"-1\" && to_gid != \"-1\" && from_gid == to_gid\n          # stop there\n          return\n    view = new FieldButton\n      model: field\n\n    view.$el.appendTo($(target, @$el))\n\n    # Save a reference of the field DOM element for ConnectionView\n    # todo: remove this... but how?\n    field.button = view.$el\n\n    @subviews.push(view)\n\n  # Unbind events, destroy jquery-ui widgets, remove dom elements\n  # and delete variables\n  remove: () =>\n    @undelegateEvents()\n    @collection.off(\"add\", @onFieldCreated)\n\n    # Remove all FieldButton subviews\n    views = @subviews.concat()\n    _.each views, (view) -> view.remove()\n\n    # Remove elements which may have events attached\n    $(\"input\", $(@el)).remove()\n\n    # Delete references\n    delete @collection\n    delete @node\n    delete @subviews\n    super\n\nmodule.exports = FieldsView\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/fields/views/FieldsView.coffee","_ = require 'Underscore'\nBackbone = require 'Backbone'\n_view_node_field_in = require '../templates/node_field_input.tmpl.html'\n_view_node_field_out = require '../templates/node_field_output.tmpl.html'\n_view_field_context_menu = require '../templates/field_context_menu.tmpl.html'\n\nrequire 'threenodes/utils/Utils'\nrequire 'libs/jquery.contextMenu'\n\n### FieldButton View ###\nclass FieldButton extends Backbone.View\n  className: \"field\"\n  # Save some options in variables and bind events\n  initialize: (options) ->\n    super\n    @makeElement()\n    @render()\n\n  remove: () =>\n    $inner = $(\".inner-field\", @$el)\n    # Remove drag & drop events\n    if $inner.data(\"droppable\") then $inner.droppable(\"destroy\")\n    if $inner.data(\"draggable\") then $inner.draggable(\"destroy\")\n\n    # Remove the inner DOM element to also unbind some possible events\n    $inner.remove()\n    super\n\n  makeElement: () =>\n    layout = if @model.get(\"is_output\") then _view_node_field_out else _view_node_field_in\n\n    bt = _.template layout,\n      fid: @model.get(\"fid\")\n      name: @model.get(\"name\")\n    @$el.html(bt)\n\n  render: () =>\n    @$el.attr(\"rel\", @model.get(\"name\"))\n    @$el.addClass(\"field-\" + @model.get(\"name\"))\n\n    @$el.data(\"object\", @model)\n    @$el.data(\"fid\", @model.get(\"fid\"))\n\n    @initContextMenu()\n    @addFieldListener()\n\n  initContextMenu: () ->\n    if $(\"#field-context-menu\").length < 1\n      menu_field_menu = _.template(_view_field_context_menu, {})\n      $(\"body\").append(menu_field_menu)\n    @$el.contextMenu {menu: \"field-context-menu\"}, (action, el, pos) =>\n      if action == \"removeConnection\" then @model.removeConnections()\n    return @\n\n  addFieldListener: () ->\n    self = this\n    field = @model\n\n    start_offset_x = 0\n    start_offset_y = 0\n\n    getPath = (start, end, offset) ->\n      ofx = $(\"#container-wrapper\").scrollLeft()\n      ofy = $(\"#container-wrapper\").scrollTop()\n      \"M#{start.left + offset.left + 2} #{start.top + offset.top + 2} L#{end.left + offset.left + ofx - start_offset_x} #{end.top + offset.top + ofy - start_offset_y}\"\n\n    highlight_possible_targets = () ->\n      target = \".outputs .field\"\n      if field.get(\"is_output\") == true\n        target = \".inputs .field\"\n      $(target).filter () ->\n        $(this).parent().parent().parent().data(\"id\") != field.node.get(\"id\")\n      .addClass \"field-possible-target\"\n\n    $(\".inner-field\", @$el).draggable\n      helper: () ->\n        $(\"<div class='ui-widget-drag-helper'></div>\")\n      scroll: true\n      cursor: 'pointer'\n      cursorAt:\n        left: 0\n        top: 0\n      start: (event, ui) ->\n        start_offset_x = $(\"#container-wrapper\").scrollLeft()\n        start_offset_y = $(\"#container-wrapper\").scrollTop()\n        highlight_possible_targets()\n        if ThreeNodes.UI.UIView.connecting_line then ThreeNodes.UI.UIView.connecting_line.attr({opacity: 1})\n      stop: (event, ui) ->\n        $(\".field\").removeClass \"field-possible-target\"\n        if ThreeNodes.UI.UIView.connecting_line then ThreeNodes.UI.UIView.connecting_line.attr({opacity: 0})\n      drag: (event, ui) ->\n        if ThreeNodes.UI.UIView.connecting_line\n          pos = $(this).position()\n          node_pos =\n            left: field.node.get(\"x\")\n            top: field.node.get(\"y\")\n          ThreeNodes.UI.UIView.connecting_line.attr\n            path: getPath(pos, ui.position, node_pos)\n          return true\n\n    accept_class = \".outputs .inner-field\"\n    if field && field.get(\"is_output\") == true\n      accept_class = \".inputs .inner-field\"\n\n    $(\".inner-field\", @$el).droppable\n      accept: accept_class\n      activeClass: \"ui-state-active\"\n      hoverClass: \"ui-state-hover\"\n      drop: (event, ui) ->\n        origin = $(ui.draggable).parent()\n        field2 = origin.data(\"object\")\n        # We need to find the most global @connections\n        # For a connection between a normal node and one in a group\n        # we want to find the global @connections\n        #\n        # For now we simply get the node from the second field if the\n        # first one has a parent node\n        #\n        # TODO: fix this for nested groups (try to connect to in ins and outs)\n        if field.node.parent\n          field2.node.createConnection(field, field2)\n        else\n          field.node.createConnection(field, field2)\n\n    return this\n\nmodule.exports = FieldButton\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/fields/views/FieldButton.coffee","module.exports = \"<span class=\\\"inner-field\\\"><span></span><%= name %></span>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./threenodes/fields/templates/node_field_input.tmpl.html\n// module id = 40\n// module chunks = 1 3","module.exports = \"<span class=\\\"inner-field\\\"><%= name %><span></span></span>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./threenodes/fields/templates/node_field_output.tmpl.html\n// module id = 41\n// module chunks = 1 3","module.exports = \"<ul id=\\\"field-context-menu\\\" class=\\\"context-menu\\\">\\n  <li><a href=\\\"#removeConnection\\\">Remove connection(s)</a></li>\\n</ul>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./threenodes/fields/templates/field_context_menu.tmpl.html\n// module id = 42\n// module chunks = 1 3","_ = require 'Underscore'\nBackbone = require 'Backbone'\nnamespace = require('libs/namespace').namespace\n\nrequire '../models/Node'\nNodeView = require './NodeView'\nrequire 'colorpicker'\n\nclass Color extends NodeView\n  initialize: (options) =>\n    super\n    # Need to compute rgb before adding the preview.\n    this.model.compute()\n    @init_preview()\n\n  init_preview: () =>\n    fields = @model.fields\n    @$picker_el = $(\"<div class='color_preview'></div>\")\n    col = fields.getField(\"rgb\", true).getValue(0)\n    @$picker_el.ColorPicker\n      color: {r: Math.ceil(col.r * 255), g: Math.ceil(col.g * 255), b: Math.ceil(col.b * 255)}\n      livePreview: false\n      onChange: (hsb, hex, rgb) =>\n        fields.getField(\"r\").setValue(rgb.r / 255)\n        fields.getField(\"g\").setValue(rgb.g / 255)\n        fields.getField(\"b\").setValue(rgb.b / 255)\n\n    $(\".center\", @$el).append(@$picker_el)\n\n    # on output value change set preview color\n    fields.getField(\"rgb\", true).on_value_update_hooks.set_bg_color_preview = (v) =>\n      @$picker_el.css\n        background: v[0].getStyle()\n\n  remove: () =>\n    @$picker_el.each () ->\n      if $(this).data('colorpickerId')\n        cal = $('#' + $(this).data('colorpickerId'))\n        picker = cal.data('colorpicker')\n        if picker\n          delete picker.onChange\n        # remove colorpicker dom element\n        cal.remove()\n    @$picker_el.unbind()\n    @$picker_el.remove()\n    delete @$picker_el\n    super\n\nmodule.exports = Color\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/nodes/views/Color.coffee","/**\r\n *\r\n * Color picker\r\n * Author: Stefan Petre www.eyecon.ro\r\n * \r\n * Dual licensed under the MIT and GPL licenses\r\n * \r\n */\r\n(function ($) {\r\n\tvar ColorPicker = function () {\r\n\t\tvar\r\n\t\t\tids = {},\r\n\t\t\tinAction,\r\n\t\t\tcharMin = 65,\r\n\t\t\tvisible,\r\n\t\t\ttpl = '<div class=\"colorpicker\"><div class=\"colorpicker_color\"><div><div></div></div></div><div class=\"colorpicker_hue\"><div></div></div><div class=\"colorpicker_new_color\"></div><div class=\"colorpicker_current_color\"></div><div class=\"colorpicker_hex\"><input type=\"text\" maxlength=\"6\" size=\"6\" /></div><div class=\"colorpicker_rgb_r colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_rgb_g colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_rgb_b colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_h colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_s colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_hsb_b colorpicker_field\"><input type=\"text\" maxlength=\"3\" size=\"3\" /><span></span></div><div class=\"colorpicker_submit\"></div></div>',\r\n\t\t\tdefaults = {\r\n\t\t\t\teventName: 'click',\r\n\t\t\t\tonShow: function () {},\r\n\t\t\t\tonBeforeShow: function(){},\r\n\t\t\t\tonHide: function () {},\r\n\t\t\t\tonChange: function () {},\r\n\t\t\t\tonSubmit: function () {},\r\n\t\t\t\tcolor: 'ff0000',\r\n\t\t\t\tlivePreview: true,\r\n\t\t\t\tflat: false\r\n\t\t\t},\r\n\t\t\tfillRGBFields = function  (hsb, cal) {\r\n\t\t\t\tvar rgb = HSBToRGB(hsb);\r\n\t\t\t\t$(cal).data('colorpicker').fields\r\n\t\t\t\t\t.eq(1).val(rgb.r).end()\r\n\t\t\t\t\t.eq(2).val(rgb.g).end()\r\n\t\t\t\t\t.eq(3).val(rgb.b).end();\r\n\t\t\t},\r\n\t\t\tfillHSBFields = function  (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').fields\r\n\t\t\t\t\t.eq(4).val(hsb.h).end()\r\n\t\t\t\t\t.eq(5).val(hsb.s).end()\r\n\t\t\t\t\t.eq(6).val(hsb.b).end();\r\n\t\t\t},\r\n\t\t\tfillHexFields = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').fields\r\n\t\t\t\t\t.eq(0).val(HSBToHex(hsb)).end();\r\n\t\t\t},\r\n\t\t\tsetSelector = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').selector.css('backgroundColor', '#' + HSBToHex({h: hsb.h, s: 100, b: 100}));\r\n\t\t\t\t$(cal).data('colorpicker').selectorIndic.css({\r\n\t\t\t\t\tleft: parseInt(150 * hsb.s/100, 10),\r\n\t\t\t\t\ttop: parseInt(150 * (100-hsb.b)/100, 10)\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tsetHue = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').hue.css('top', parseInt(150 - 150 * hsb.h/360, 10));\r\n\t\t\t},\r\n\t\t\tsetCurrentColor = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').currentColor.css('backgroundColor', '#' + HSBToHex(hsb));\r\n\t\t\t},\r\n\t\t\tsetNewColor = function (hsb, cal) {\r\n\t\t\t\t$(cal).data('colorpicker').newColor.css('backgroundColor', '#' + HSBToHex(hsb));\r\n\t\t\t},\r\n\t\t\tkeyDown = function (ev) {\r\n\t\t\t\tvar pressedKey = ev.charCode || ev.keyCode || -1;\r\n\t\t\t\tif ((pressedKey > charMin && pressedKey <= 90) || pressedKey == 32) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvar cal = $(this).parent().parent();\r\n\t\t\t\tif (cal.data('colorpicker').livePreview === true) {\r\n\t\t\t\t\tchange.apply(this);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tchange = function (ev) {\r\n\t\t\t\tvar cal = $(this).parent().parent(), col;\r\n\t\t\t\tif (this.parentNode.className.indexOf('_hex') > 0) {\r\n\t\t\t\t\tcal.data('colorpicker').color = col = HexToHSB(fixHex(this.value));\r\n\t\t\t\t} else if (this.parentNode.className.indexOf('_hsb') > 0) {\r\n\t\t\t\t\tcal.data('colorpicker').color = col = fixHSB({\r\n\t\t\t\t\t\th: parseInt(cal.data('colorpicker').fields.eq(4).val(), 10),\r\n\t\t\t\t\t\ts: parseInt(cal.data('colorpicker').fields.eq(5).val(), 10),\r\n\t\t\t\t\t\tb: parseInt(cal.data('colorpicker').fields.eq(6).val(), 10)\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tcal.data('colorpicker').color = col = RGBToHSB(fixRGB({\r\n\t\t\t\t\t\tr: parseInt(cal.data('colorpicker').fields.eq(1).val(), 10),\r\n\t\t\t\t\t\tg: parseInt(cal.data('colorpicker').fields.eq(2).val(), 10),\r\n\t\t\t\t\t\tb: parseInt(cal.data('colorpicker').fields.eq(3).val(), 10)\r\n\t\t\t\t\t}));\r\n\t\t\t\t}\r\n\t\t\t\tif (ev) {\r\n\t\t\t\t\tfillRGBFields(col, cal.get(0));\r\n\t\t\t\t\tfillHexFields(col, cal.get(0));\r\n\t\t\t\t\tfillHSBFields(col, cal.get(0));\r\n\t\t\t\t}\r\n\t\t\t\tsetSelector(col, cal.get(0));\r\n\t\t\t\tsetHue(col, cal.get(0));\r\n\t\t\t\tsetNewColor(col, cal.get(0));\r\n\t\t\t\tcal.data('colorpicker').onChange.apply(cal, [col, HSBToHex(col), HSBToRGB(col)]);\r\n\t\t\t},\r\n\t\t\tblur = function (ev) {\r\n\t\t\t\tvar cal = $(this).parent().parent();\r\n\t\t\t\tcal.data('colorpicker').fields.parent().removeClass('colorpicker_focus');\r\n\t\t\t},\r\n\t\t\tfocus = function () {\r\n\t\t\t\tcharMin = this.parentNode.className.indexOf('_hex') > 0 ? 70 : 65;\r\n\t\t\t\t$(this).parent().parent().data('colorpicker').fields.parent().removeClass('colorpicker_focus');\r\n\t\t\t\t$(this).parent().addClass('colorpicker_focus');\r\n\t\t\t},\r\n\t\t\tdownIncrement = function (ev) {\r\n\t\t\t\tvar field = $(this).parent().find('input').focus();\r\n\t\t\t\tvar current = {\r\n\t\t\t\t\tel: $(this).parent().addClass('colorpicker_slider'),\r\n\t\t\t\t\tmax: this.parentNode.className.indexOf('_hsb_h') > 0 ? 360 : (this.parentNode.className.indexOf('_hsb') > 0 ? 100 : 255),\r\n\t\t\t\t\ty: ev.pageY,\r\n\t\t\t\t\tfield: field,\r\n\t\t\t\t\tval: parseInt(field.val(), 10),\r\n\t\t\t\t\tpreview: $(this).parent().parent().data('colorpicker').livePreview\t\t\t\t\t\r\n\t\t\t\t};\r\n\t\t\t\t$(document).bind('mouseup', current, upIncrement);\r\n\t\t\t\t$(document).bind('mousemove', current, moveIncrement);\r\n\t\t\t},\r\n\t\t\tmoveIncrement = function (ev) {\r\n\t\t\t\tev.data.field.val(Math.max(0, Math.min(ev.data.max, parseInt(ev.data.val + ev.pageY - ev.data.y, 10))));\r\n\t\t\t\tif (ev.data.preview) {\r\n\t\t\t\t\tchange.apply(ev.data.field.get(0), [true]);\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tupIncrement = function (ev) {\r\n\t\t\t\tchange.apply(ev.data.field.get(0), [true]);\r\n\t\t\t\tev.data.el.removeClass('colorpicker_slider').find('input').focus();\r\n\t\t\t\t$(document).unbind('mouseup', upIncrement);\r\n\t\t\t\t$(document).unbind('mousemove', moveIncrement);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tdownHue = function (ev) {\r\n\t\t\t\tvar current = {\r\n\t\t\t\t\tcal: $(this).parent(),\r\n\t\t\t\t\ty: $(this).offset().top\r\n\t\t\t\t};\r\n\t\t\t\tcurrent.preview = current.cal.data('colorpicker').livePreview;\r\n\t\t\t\t$(document).bind('mouseup', current, upHue);\r\n\t\t\t\t$(document).bind('mousemove', current, moveHue);\r\n\t\t\t},\r\n\t\t\tmoveHue = function (ev) {\r\n\t\t\t\tchange.apply(\r\n\t\t\t\t\tev.data.cal.data('colorpicker')\r\n\t\t\t\t\t\t.fields\r\n\t\t\t\t\t\t.eq(4)\r\n\t\t\t\t\t\t.val(parseInt(360*(150 - Math.max(0,Math.min(150,(ev.pageY - ev.data.y))))/150, 10))\r\n\t\t\t\t\t\t.get(0),\r\n\t\t\t\t\t[ev.data.preview]\r\n\t\t\t\t);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tupHue = function (ev) {\r\n\t\t\t\tfillRGBFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\r\n\t\t\t\tfillHexFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\r\n\t\t\t\t$(document).unbind('mouseup', upHue);\r\n\t\t\t\t$(document).unbind('mousemove', moveHue);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tdownSelector = function (ev) {\r\n\t\t\t\tvar current = {\r\n\t\t\t\t\tcal: $(this).parent(),\r\n\t\t\t\t\tpos: $(this).offset()\r\n\t\t\t\t};\r\n\t\t\t\tcurrent.preview = current.cal.data('colorpicker').livePreview;\r\n\t\t\t\t$(document).bind('mouseup', current, upSelector);\r\n\t\t\t\t$(document).bind('mousemove', current, moveSelector);\r\n\t\t\t},\r\n\t\t\tmoveSelector = function (ev) {\r\n\t\t\t\tchange.apply(\r\n\t\t\t\t\tev.data.cal.data('colorpicker')\r\n\t\t\t\t\t\t.fields\r\n\t\t\t\t\t\t.eq(6)\r\n\t\t\t\t\t\t.val(parseInt(100*(150 - Math.max(0,Math.min(150,(ev.pageY - ev.data.pos.top))))/150, 10))\r\n\t\t\t\t\t\t.end()\r\n\t\t\t\t\t\t.eq(5)\r\n\t\t\t\t\t\t.val(parseInt(100*(Math.max(0,Math.min(150,(ev.pageX - ev.data.pos.left))))/150, 10))\r\n\t\t\t\t\t\t.get(0),\r\n\t\t\t\t\t[ev.data.preview]\r\n\t\t\t\t);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tupSelector = function (ev) {\r\n\t\t\t\tfillRGBFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\r\n\t\t\t\tfillHexFields(ev.data.cal.data('colorpicker').color, ev.data.cal.get(0));\r\n\t\t\t\t$(document).unbind('mouseup', upSelector);\r\n\t\t\t\t$(document).unbind('mousemove', moveSelector);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tenterSubmit = function (ev) {\r\n\t\t\t\t$(this).addClass('colorpicker_focus');\r\n\t\t\t},\r\n\t\t\tleaveSubmit = function (ev) {\r\n\t\t\t\t$(this).removeClass('colorpicker_focus');\r\n\t\t\t},\r\n\t\t\tclickSubmit = function (ev) {\r\n\t\t\t\tvar cal = $(this).parent();\r\n\t\t\t\tvar col = cal.data('colorpicker').color;\r\n\t\t\t\tcal.data('colorpicker').origColor = col;\r\n\t\t\t\tsetCurrentColor(col, cal.get(0));\r\n\t\t\t\tcal.data('colorpicker').onSubmit(col, HSBToHex(col), HSBToRGB(col), cal.data('colorpicker').el);\r\n\t\t\t},\r\n\t\t\tshow = function (ev) {\r\n\t\t\t\tvar cal = $('#' + $(this).data('colorpickerId'));\r\n\t\t\t\tcal.data('colorpicker').onBeforeShow.apply(this, [cal.get(0)]);\r\n\t\t\t\tvar pos = $(this).offset();\r\n\t\t\t\tvar viewPort = getViewport();\r\n\t\t\t\tvar top = pos.top + this.offsetHeight;\r\n\t\t\t\tvar left = pos.left;\r\n\t\t\t\tif (top + 176 > viewPort.t + viewPort.h) {\r\n\t\t\t\t\ttop -= this.offsetHeight + 176;\r\n\t\t\t\t}\r\n\t\t\t\tif (left + 356 > viewPort.l + viewPort.w) {\r\n\t\t\t\t\tleft -= 356;\r\n\t\t\t\t}\r\n\t\t\t\tcal.css({left: left + 'px', top: top + 'px'});\r\n\t\t\t\tif (cal.data('colorpicker').onShow.apply(this, [cal.get(0)]) != false) {\r\n\t\t\t\t\tcal.show();\r\n\t\t\t\t}\r\n\t\t\t\t$(document).bind('mousedown', {cal: cal}, hide);\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\thide = function (ev) {\r\n\t\t\t\tif (!isChildOf(ev.data.cal.get(0), ev.target, ev.data.cal.get(0))) {\r\n\t\t\t\t\tif (ev.data.cal.data('colorpicker').onHide.apply(this, [ev.data.cal.get(0)]) != false) {\r\n\t\t\t\t\t\tev.data.cal.hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$(document).unbind('mousedown', hide);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tisChildOf = function(parentEl, el, container) {\r\n\t\t\t\tif (parentEl == el) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\tif (parentEl.contains) {\r\n\t\t\t\t\treturn parentEl.contains(el);\r\n\t\t\t\t}\r\n\t\t\t\tif ( parentEl.compareDocumentPosition ) {\r\n\t\t\t\t\treturn !!(parentEl.compareDocumentPosition(el) & 16);\r\n\t\t\t\t}\r\n\t\t\t\tvar prEl = el.parentNode;\r\n\t\t\t\twhile(prEl && prEl != container) {\r\n\t\t\t\t\tif (prEl == parentEl)\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\tprEl = prEl.parentNode;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tgetViewport = function () {\r\n\t\t\t\tvar m = document.compatMode == 'CSS1Compat';\r\n\t\t\t\treturn {\r\n\t\t\t\t\tl : window.pageXOffset || (m ? document.documentElement.scrollLeft : document.body.scrollLeft),\r\n\t\t\t\t\tt : window.pageYOffset || (m ? document.documentElement.scrollTop : document.body.scrollTop),\r\n\t\t\t\t\tw : window.innerWidth || (m ? document.documentElement.clientWidth : document.body.clientWidth),\r\n\t\t\t\t\th : window.innerHeight || (m ? document.documentElement.clientHeight : document.body.clientHeight)\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tfixHSB = function (hsb) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\th: Math.min(360, Math.max(0, hsb.h)),\r\n\t\t\t\t\ts: Math.min(100, Math.max(0, hsb.s)),\r\n\t\t\t\t\tb: Math.min(100, Math.max(0, hsb.b))\r\n\t\t\t\t};\r\n\t\t\t}, \r\n\t\t\tfixRGB = function (rgb) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tr: Math.min(255, Math.max(0, rgb.r)),\r\n\t\t\t\t\tg: Math.min(255, Math.max(0, rgb.g)),\r\n\t\t\t\t\tb: Math.min(255, Math.max(0, rgb.b))\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tfixHex = function (hex) {\r\n\t\t\t\tvar len = 6 - hex.length;\r\n\t\t\t\tif (len > 0) {\r\n\t\t\t\t\tvar o = [];\r\n\t\t\t\t\tfor (var i=0; i<len; i++) {\r\n\t\t\t\t\t\to.push('0');\r\n\t\t\t\t\t}\r\n\t\t\t\t\to.push(hex);\r\n\t\t\t\t\thex = o.join('');\r\n\t\t\t\t}\r\n\t\t\t\treturn hex;\r\n\t\t\t}, \r\n\t\t\tHexToRGB = function (hex) {\r\n\t\t\t\tvar hex = parseInt(((hex.indexOf('#') > -1) ? hex.substring(1) : hex), 16);\r\n\t\t\t\treturn {r: hex >> 16, g: (hex & 0x00FF00) >> 8, b: (hex & 0x0000FF)};\r\n\t\t\t},\r\n\t\t\tHexToHSB = function (hex) {\r\n\t\t\t\treturn RGBToHSB(HexToRGB(hex));\r\n\t\t\t},\r\n\t\t\tRGBToHSB = function (rgb) {\r\n\t\t\t\tvar hsb = {\r\n\t\t\t\t\th: 0,\r\n\t\t\t\t\ts: 0,\r\n\t\t\t\t\tb: 0\r\n\t\t\t\t};\r\n\t\t\t\tvar min = Math.min(rgb.r, rgb.g, rgb.b);\r\n\t\t\t\tvar max = Math.max(rgb.r, rgb.g, rgb.b);\r\n\t\t\t\tvar delta = max - min;\r\n\t\t\t\thsb.b = max;\r\n\t\t\t\tif (max != 0) {\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\thsb.s = max != 0 ? 255 * delta / max : 0;\r\n\t\t\t\tif (hsb.s != 0) {\r\n\t\t\t\t\tif (rgb.r == max) {\r\n\t\t\t\t\t\thsb.h = (rgb.g - rgb.b) / delta;\r\n\t\t\t\t\t} else if (rgb.g == max) {\r\n\t\t\t\t\t\thsb.h = 2 + (rgb.b - rgb.r) / delta;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\thsb.h = 4 + (rgb.r - rgb.g) / delta;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\thsb.h = -1;\r\n\t\t\t\t}\r\n\t\t\t\thsb.h *= 60;\r\n\t\t\t\tif (hsb.h < 0) {\r\n\t\t\t\t\thsb.h += 360;\r\n\t\t\t\t}\r\n\t\t\t\thsb.s *= 100/255;\r\n\t\t\t\thsb.b *= 100/255;\r\n\t\t\t\treturn hsb;\r\n\t\t\t},\r\n\t\t\tHSBToRGB = function (hsb) {\r\n\t\t\t\tvar rgb = {};\r\n\t\t\t\tvar h = Math.round(hsb.h);\r\n\t\t\t\tvar s = Math.round(hsb.s*255/100);\r\n\t\t\t\tvar v = Math.round(hsb.b*255/100);\r\n\t\t\t\tif(s == 0) {\r\n\t\t\t\t\trgb.r = rgb.g = rgb.b = v;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar t1 = v;\r\n\t\t\t\t\tvar t2 = (255-s)*v/255;\r\n\t\t\t\t\tvar t3 = (t1-t2)*(h%60)/60;\r\n\t\t\t\t\tif(h==360) h = 0;\r\n\t\t\t\t\tif(h<60) {rgb.r=t1;\trgb.b=t2; rgb.g=t2+t3}\r\n\t\t\t\t\telse if(h<120) {rgb.g=t1; rgb.b=t2;\trgb.r=t1-t3}\r\n\t\t\t\t\telse if(h<180) {rgb.g=t1; rgb.r=t2;\trgb.b=t2+t3}\r\n\t\t\t\t\telse if(h<240) {rgb.b=t1; rgb.r=t2;\trgb.g=t1-t3}\r\n\t\t\t\t\telse if(h<300) {rgb.b=t1; rgb.g=t2;\trgb.r=t2+t3}\r\n\t\t\t\t\telse if(h<360) {rgb.r=t1; rgb.g=t2;\trgb.b=t1-t3}\r\n\t\t\t\t\telse {rgb.r=0; rgb.g=0;\trgb.b=0}\r\n\t\t\t\t}\r\n\t\t\t\treturn {r:Math.round(rgb.r), g:Math.round(rgb.g), b:Math.round(rgb.b)};\r\n\t\t\t},\r\n\t\t\tRGBToHex = function (rgb) {\r\n\t\t\t\tvar hex = [\r\n\t\t\t\t\trgb.r.toString(16),\r\n\t\t\t\t\trgb.g.toString(16),\r\n\t\t\t\t\trgb.b.toString(16)\r\n\t\t\t\t];\r\n\t\t\t\t$.each(hex, function (nr, val) {\r\n\t\t\t\t\tif (val.length == 1) {\r\n\t\t\t\t\t\thex[nr] = '0' + val;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn hex.join('');\r\n\t\t\t},\r\n\t\t\tHSBToHex = function (hsb) {\r\n\t\t\t\treturn RGBToHex(HSBToRGB(hsb));\r\n\t\t\t},\r\n\t\t\trestoreOriginal = function () {\r\n\t\t\t\tvar cal = $(this).parent();\r\n\t\t\t\tvar col = cal.data('colorpicker').origColor;\r\n\t\t\t\tcal.data('colorpicker').color = col;\r\n\t\t\t\tfillRGBFields(col, cal.get(0));\r\n\t\t\t\tfillHexFields(col, cal.get(0));\r\n\t\t\t\tfillHSBFields(col, cal.get(0));\r\n\t\t\t\tsetSelector(col, cal.get(0));\r\n\t\t\t\tsetHue(col, cal.get(0));\r\n\t\t\t\tsetNewColor(col, cal.get(0));\r\n\t\t\t};\r\n\t\treturn {\r\n\t\t\tinit: function (opt) {\r\n\t\t\t\topt = $.extend({}, defaults, opt||{});\r\n\t\t\t\tif (typeof opt.color == 'string') {\r\n\t\t\t\t\topt.color = HexToHSB(opt.color);\r\n\t\t\t\t} else if (opt.color.r != undefined && opt.color.g != undefined && opt.color.b != undefined) {\r\n\t\t\t\t\topt.color = RGBToHSB(opt.color);\r\n\t\t\t\t} else if (opt.color.h != undefined && opt.color.s != undefined && opt.color.b != undefined) {\r\n\t\t\t\t\topt.color = fixHSB(opt.color);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t}\r\n\t\t\t\treturn this.each(function () {\r\n\t\t\t\t\tif (!$(this).data('colorpickerId')) {\r\n\t\t\t\t\t\tvar options = $.extend({}, opt);\r\n\t\t\t\t\t\toptions.origColor = opt.color;\r\n\t\t\t\t\t\tvar id = 'collorpicker_' + parseInt(Math.random() * 1000);\r\n\t\t\t\t\t\t$(this).data('colorpickerId', id);\r\n\t\t\t\t\t\tvar cal = $(tpl).attr('id', id);\r\n\t\t\t\t\t\tif (options.flat) {\r\n\t\t\t\t\t\t\tcal.appendTo(this).show();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcal.appendTo(document.body);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\toptions.fields = cal\r\n\t\t\t\t\t\t\t\t\t\t\t.find('input')\r\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('keyup', keyDown)\r\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('change', change)\r\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('blur', blur)\r\n\t\t\t\t\t\t\t\t\t\t\t\t.bind('focus', focus);\r\n\t\t\t\t\t\tcal\r\n\t\t\t\t\t\t\t.find('span').bind('mousedown', downIncrement).end()\r\n\t\t\t\t\t\t\t.find('>div.colorpicker_current_color').bind('click', restoreOriginal);\r\n\t\t\t\t\t\toptions.selector = cal.find('div.colorpicker_color').bind('mousedown', downSelector);\r\n\t\t\t\t\t\toptions.selectorIndic = options.selector.find('div div');\r\n\t\t\t\t\t\toptions.el = this;\r\n\t\t\t\t\t\toptions.hue = cal.find('div.colorpicker_hue div');\r\n\t\t\t\t\t\tcal.find('div.colorpicker_hue').bind('mousedown', downHue);\r\n\t\t\t\t\t\toptions.newColor = cal.find('div.colorpicker_new_color');\r\n\t\t\t\t\t\toptions.currentColor = cal.find('div.colorpicker_current_color');\r\n\t\t\t\t\t\tcal.data('colorpicker', options);\r\n\t\t\t\t\t\tcal.find('div.colorpicker_submit')\r\n\t\t\t\t\t\t\t.bind('mouseenter', enterSubmit)\r\n\t\t\t\t\t\t\t.bind('mouseleave', leaveSubmit)\r\n\t\t\t\t\t\t\t.bind('click', clickSubmit);\r\n\t\t\t\t\t\tfillRGBFields(options.color, cal.get(0));\r\n\t\t\t\t\t\tfillHSBFields(options.color, cal.get(0));\r\n\t\t\t\t\t\tfillHexFields(options.color, cal.get(0));\r\n\t\t\t\t\t\tsetHue(options.color, cal.get(0));\r\n\t\t\t\t\t\tsetSelector(options.color, cal.get(0));\r\n\t\t\t\t\t\tsetCurrentColor(options.color, cal.get(0));\r\n\t\t\t\t\t\tsetNewColor(options.color, cal.get(0));\r\n\t\t\t\t\t\tconsole.log(options);\r\n\t\t\t\t\t\tif (options.flat) {\r\n\t\t\t\t\t\t\tcal.css({\r\n\t\t\t\t\t\t\t\tposition: 'relative',\r\n\t\t\t\t\t\t\t\tdisplay: 'block'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$(this).bind(options.eventName, show);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tshowPicker: function() {\r\n\t\t\t\treturn this.each( function () {\r\n\t\t\t\t\tif ($(this).data('colorpickerId')) {\r\n\t\t\t\t\t\tshow.apply(this);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\thidePicker: function() {\r\n\t\t\t\treturn this.each( function () {\r\n\t\t\t\t\tif ($(this).data('colorpickerId')) {\r\n\t\t\t\t\t\t$('#' + $(this).data('colorpickerId')).hide();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tsetColor: function(col) {\r\n\t\t\t\tif (typeof col == 'string') {\r\n\t\t\t\t\tcol = HexToHSB(col);\r\n\t\t\t\t} else if (col.r != undefined && col.g != undefined && col.b != undefined) {\r\n\t\t\t\t\tcol = RGBToHSB(col);\r\n\t\t\t\t} else if (col.h != undefined && col.s != undefined && col.b != undefined) {\r\n\t\t\t\t\tcol = fixHSB(col);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t}\r\n\t\t\t\treturn this.each(function(){\r\n\t\t\t\t\tif ($(this).data('colorpickerId')) {\r\n\t\t\t\t\t\tvar cal = $('#' + $(this).data('colorpickerId'));\r\n\t\t\t\t\t\tcal.data('colorpicker').color = col;\r\n\t\t\t\t\t\tcal.data('colorpicker').origColor = col;\r\n\t\t\t\t\t\tfillRGBFields(col, cal.get(0));\r\n\t\t\t\t\t\tfillHSBFields(col, cal.get(0));\r\n\t\t\t\t\t\tfillHexFields(col, cal.get(0));\r\n\t\t\t\t\t\tsetHue(col, cal.get(0));\r\n\t\t\t\t\t\tsetSelector(col, cal.get(0));\r\n\t\t\t\t\t\tsetCurrentColor(col, cal.get(0));\r\n\t\t\t\t\t\tsetNewColor(col, cal.get(0));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t}();\r\n\t$.fn.extend({\r\n\t\tColorPicker: ColorPicker.init,\r\n\t\tColorPickerHide: ColorPicker.hidePicker,\r\n\t\tColorPickerShow: ColorPicker.showPicker,\r\n\t\tColorPickerSetColor: ColorPicker.setColor\r\n\t});\r\n})(jQuery)\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./libs/colorpicker/js/colorpicker.js\n// module id = 44\n// module chunks = 1 3","module.exports = __WEBPACK_EXTERNAL_MODULE_80__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Blob\"\n// module id = 80\n// module chunks = 2 3","module.exports = __WEBPACK_EXTERNAL_MODULE_81__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"FileSaver\"\n// module id = 81\n// module chunks = 2 3","### UI View ###\n_ = require 'Underscore'\nBackbone = require 'Backbone'\n_view_app_ui = require 'templates/app_ui.tmpl.html'\nSidebar = require './sidebar/Sidebar'\nBreadcrumb = require './Breadcrumb'\nMenuBar = require './MenuBar'\n\nrequire 'RequestAnimationFrame'\nrequire 'Raphael'\nrequire 'jquery.ui'\nrequire 'libs/jquery.transform2d'\nrequire 'libs/jquery-scrollview/jquery.scrollview'\nrequire 'jquery.layout'\n\nclass UIView extends Backbone.View\n\n  # Background svg used to draw the connections\n  @svg = false\n  @connecting_line = false\n\n  initialize: (options) ->\n    super\n\n    @settings = options.settings\n    @is_grabbing = false\n\n    # Bind events\n    $(window).resize(@onUiWindowResize)\n\n    # Create the ui dom elements from template\n    ui_tmpl = _.template(_view_app_ui, {})\n    @$el.append(ui_tmpl)\n\n    # Create breadcrumb view (for selecting current group/workspace)\n    @breadcrumb = new Breadcrumb({el: $(\"#breadcrumb\")})\n\n    # Setup SVG for drawing connections\n    UIView.svg = Raphael(\"graph\", 4000, 4000)\n   \n    UIView.connecting_line = UIView.svg.path(\"M0 -20 L0 -20\").attr\n      stroke: \"#fff\"\n      'stroke-dasharray': \"-\"\n      fill: \"none\"\n      opacity: 1\n\n   \n\n    # Setup the sidebar and menu subviews\n    @sidebar = new Sidebar({el: $(\"#sidebar\"), settings: @settings})\n    @initMenubar()\n\n    # Set the layout and show application\n    @initLayout()\n    @showApplication()\n\n    # Fire the first resize event\n    @onUiWindowResize()\n\n    # Start main render loop\n    @animate()\n\n\n\n  clearWorkspace: () =>\n    # Remove the nodes attributes from the sidebar\n    @sidebar.clearWorkspace()\n\n  # Setup menubar\n  initMenubar: () =>\n    menu_tmpl = _.template(MenuBar.template, {})\n    $menu_tmpl = $(menu_tmpl).prependTo(\"body\")\n    @menubar = new MenuBar\n      el: $menu_tmpl\n\n    @menubar.on \"ToggleAttributes\", () => if @layout then @layout.toggle(\"west\")\n    @menubar.on \"ToggleLibrary\", () => if @layout then @layout.toggle(\"east\")\n    @menubar.on \"ToggleTimeline\", () => if @layout then @layout.toggle(\"south\")\n\n    return this\n\n  # Setup layout\n  initLayout: () =>\n    @makeSelectable()\n    @setupMouseScroll()\n    @initBottomToolbox()\n    @initDisplayModeSwitch()\n\n    @layout = $('body').layout\n      scrollToBookmarkOnLoad: false\n      animatePaneSizing: false\n      fxName: 'none'\n      center:\n        size: \"100%\"\n      north:\n        closable: false\n        resizable: false\n        slidable: false\n        showOverflowOnHover: true\n        size: 27\n        resizerClass: \"ui-layout-resizer-hidden\"\n        spacing_open: 0\n        spacing_closed: 0\n      east:\n        minSize: 220\n        initClosed: true\n        onresize: (name, pane_el, state, opt, layout_name) =>\n          @onUiWindowResize()\n        onopen: (name, pane_el, state, opt, layout_name) =>\n          @onUiWindowResize()\n        onclose: (name, pane_el, state, opt, layout_name) =>\n          @onUiWindowResize()\n      west:\n        minSize: 220\n      south:\n        minSize: 48\n        size: 48\n        onopen: (name, pane_el, state, opt, layout_name) =>\n          @trigger(\"timelineResize\", pane_el.innerHeight())\n          @onUiWindowResize()\n        onclose: (name, pane_el, state, opt, layout_name) =>\n          @trigger(\"timelineResize\", pane_el.innerHeight())\n          @onUiWindowResize()\n        onresize: (name, pane_el, state, opt, layout_name) =>\n          @trigger(\"timelineResize\", pane_el.innerHeight())\n          @onUiWindowResize()\n\n    # Set timeline height\n    @trigger(\"timelineResize\", 48)\n    return this\n\n  # Handle the nodes selection\n  makeSelectable: () ->\n    $(\"#container\").selectable\n      filter: \".nodes-container >div\"\n      stop: (event, ui) =>\n        $selected = $(\".node.ui-selected\")\n        nodes = []\n        # anims = []\n        # Add the nodes and their anims container to some arrays\n        $selected.each () ->\n          ob = $(this).data(\"object\")\n          if !ob.get(\"parent\")\n            # ob.anim.objectTrack.name = ob.get(\"name\")\n            # anims.push(ob.anim)\n            nodes.push(ob)\n          else\n            # if this is a subnode we only select the group\n            obgrp = ob.get(\"parent\")\n            # obgrp.anim.objectTrack.name = ob.get(\"name\")\n            # add the object only once\n            if !_.find(nodes, (n) -> n.id == obgrp.id)\n              # anims.push(obgrp.anim)\n              nodes.push(obgrp)\n        # Display the selected nodes attributes in the sidebar\n        @sidebar.clearNodesAttributes()\n        @sidebar.renderNodesAttributes(nodes)\n        # Display the selected nodes in the timeline\n        # @trigger(\"selectAnims\", anims)\n\n    # Quick fix for input blur.\n    # Without this, after focusing an input in a node it was difficult\n    # to unfocus it. Clicking on the workspace didn't worked.\n    # The problem come from the selectable above which prevent event propagation\n    # somewhere.\n    $(\"#container\").mousedown (e) ->\n      $('input, textarea').trigger('blur')\n    return @\n\n  # Switch between player/editor mode\n  setDisplayMode: (is_player = false) =>\n    if is_player == true\n      $(\"body\").addClass(\"player-mode\")\n      $(\"body\").removeClass(\"editor-mode\")\n      $(\"#display-mode-switch\").html(\"\")\n    else\n      $(\"body\").addClass(\"editor-mode\")\n      $(\"body\").removeClass(\"player-mode\")\n      $(\"#display-mode-switch\").html(\"player mode\")\n\n    $(\"#display-mode-switch\").toggleClass(\"icon-pencil\", is_player)\n    @settings.player_mode = is_player\n    if is_player == false\n      @trigger(\"renderConnections\")\n    return true\n\n  setupMouseScroll: () =>\n    @scroll_target = $(\"#container-wrapper\")\n\n    # Return true if the click is made on the background, false otherwise\n    is_from_target = (e) ->\n      if e.target == $(\"#graph svg\")[0]\n        return true\n      return false\n\n    # Disable the context menu on the container so that we can drag with right click\n    @scroll_target.bind \"contextmenu\", (e) -> return false\n\n    # Handle start drag\n    @scroll_target.mousedown (e) =>\n      # Init drag only if middle or right click AND if the target element is the svg\n      if is_from_target(e) && (e.which == 2 || e.which == 3)\n        @is_grabbing = true\n        @xp = e.pageX\n        @yp = e.pageY\n        return false\n\n    # Hande drag when the mouse move\n    @scroll_target.mousemove (e) =>\n      if is_from_target(e) && (@is_grabbing == true)\n        @scrollTo(@xp - e.pageX, @yp - e.pageY)\n        @xp = e.pageX\n        @yp = e.pageY\n\n    # Handle stop drag\n    @scroll_target.mouseout => @is_grabbing = false\n    @scroll_target.mouseup (e) =>\n      if is_from_target(e) && (e.which == 2 || e.which == 3)\n        @is_grabbing = false\n\n    return true\n\n  scrollTo: (dx, dy) =>\n    x = @scroll_target.scrollLeft() + dx\n    y = @scroll_target.scrollTop() + dy\n    @scroll_target.scrollLeft(x).scrollTop(y)\n\n  switchDisplayMode: () =>\n    @setDisplayMode(!@settings.player_mode)\n    return this\n\n  initDisplayModeSwitch: () =>\n    $(\"body\").append(\"<div id='display-mode-switch'>switch mode</div>\")\n    $(\"#display-mode-switch\").click (e) =>\n      @switchDisplayMode()\n\n  # Setup the bottom right dom container\n  initBottomToolbox: () =>\n    $(\"body\").append(\"<div id='bottom-toolbox'></div>\")\n    $container = $(\"#bottom-toolbox\")\n    @initResizeSlider($container)\n\n  # Initialize the little node zoom slider\n  initResizeSlider: ($container) =>\n    $container.append(\"<div id='zoom-slider'></div>\")\n    scale_graph = (val) ->\n      factor = val / 100\n      $(\"#container\").css('transform', \"scale(#{factor}, #{factor})\")\n\n    $(\"#zoom-slider\").slider\n      min: 25\n      step: 25\n      value: 100\n      change: (event, ui) -> scale_graph(ui.value)\n      slide: (event, ui) -> scale_graph(ui.value)\n\n  # Display the app and hide the intro\n  showApplication: () =>\n    delay_intro = 500\n\n    # Display/hide with some delay\n    $(\"body > header\").delay(delay_intro).hide()\n    $(\"#sidebar\").delay(delay_intro).show()\n    $(\"#container-wrapper\").delay(delay_intro).show()\n\n    # Render the connections if needed\n    @trigger(\"renderConnections\")\n\n  # Function called when the window is resized and if some panels are closed/opened/resized\n  onUiWindowResize: () =>\n    # Default minimum margins\n    margin_bottom = 20\n    margin_right = 25\n\n    # Calculate the bottom and right margins if the corresponding panels are not closed\n    if @layout.south.state.isClosed == false then margin_bottom += $(\"#timeline\").innerHeight()\n    if @layout.east.state.isClosed == false then margin_right += $(\"#library\").innerWidth()\n\n    # Apply the margins to some DOM elements\n    $(\"#bottom-toolbox\").attr(\"style\", \"bottom: #{margin_bottom}px !important; right: #{margin_right}px\")\n    $(\"#webgl-window\").css\n      right: margin_right\n\n  animate: () =>\n    @trigger(\"render\")\n    requestAnimationFrame( @animate )\n\nmodule.exports = UIView\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/views/UIView.coffee","module.exports = \"<div id='container-wrapper' class=\\\"ui-layout-center\\\">\\n  <div id='container'>\\n    <div id='graph'></div>\\n  </div>\\n  <div id=\\\"breadcrumb\\\"></div>\\n</div>\\n<div id='sidebar' class=\\\"ui-layout-west\\\">\\n  <ul class=\\\"ui-layout-north\\\">\\n    <li><a href='#tab-new'>New</a></li>\\n    <li><a href='#tab-attribute'>Attributes</a></li>\\n    <!-- <li><a href='#tab-list'>List</a></li> -->\\n  </ul>\\n  <div class=\\\"container ui-layout-center\\\">\\n    <div id='tab-attribute'></div>\\n    <div id='tab-new'>\\n      <!-- <input id='node_filter' name='search-node' placeholder='Search' type='input' /> -->\\n    </div>\\n    <!-- <div id='tab-list'></div> -->\\n  </div>\\n</div>\\n<div id=\\\"library\\\" class=\\\"ui-layout-east\\\"></div>\\n<div id=\\\"timeline\\\" class=\\\"ui-layout-south\\\"></div>\\n<input id='main_file_input_open' multiple='false' type='file' />\\n\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./templates/app_ui.tmpl.html\n// module id = 91\n// module chunks = 3","#\"use strict\"\n_ = require 'Underscore'\nBackbone = require 'Backbone'\nNodeSidebarView = require 'threenodes/views/sidebar/NodeSidebarView'\nTreeView = require 'threenodes/views/TreeView'\n\nrequire 'jquery.ui'\n\n### Sidebar View ###\nclass Sidebar extends Backbone.View\n  initialize: (options) ->\n    super\n    @settings = options.settings\n    # Keep references of node attributes subviews\n    @node_views = []\n    @initNewNode()\n    @initSearch()\n    @initTabs()\n    # @initTreeView()\n    @layout = @$el.layout\n      scrollToBookmarkOnLoad: false\n      north:\n        closable: false\n        resizable: false\n        slidable: false\n        #size: 24\n        resizerClass: \"ui-layout-resizer-hidden\"\n        spacing_open: 0\n        spacing_closed: 0\n      center:\n        size: \"100%\"\n\n  initTreeView: () =>\n    @treeview = new TreeView\n      el: $(\"#tab-list\")\n    return this\n\n  render: (nodes) =>\n    if @treeview then @treeview.render(nodes)\n\n  clearWorkspace: () =>\n    # @treeview.render(false)\n\n  initTabs: () =>\n    @$el.tabs\n      fx:\n        opacity: 'toggle'\n        duration: 100\n    return this\n\n  clearNodesAttributes: () =>\n    removeExistingNodes = () =>\n      if @node_views.length > 0\n        _.each @node_views, (view) -> view.remove()\n        @node_views = []\n\n    removeExistingNodes()\n\n    # Always start with an empty element\n    $target = $(\"#tab-attribute\")\n    $target.html(\"\");\n    return this\n\n  # Display fields attributes in sidebar when nodes are selected\n  renderNodesAttributes: (nodes) =>\n    $target = $(\"#tab-attribute\")\n    # If there is no nodes to show abort now\n    if !nodes || nodes.length < 1\n      return this\n\n    for node in nodes\n      if node.get(\"type\") != \"Group\"\n        view = new NodeSidebarView\n          model: node\n          #el: $target\n        $target.append(view.el)\n        @node_views.push view\n      else\n        # We render a group of subnodes\n        $target.append(\"<h3>#{node.get(\"name\")}</h3>\")\n        nodes_grp = node.nodes.models\n        @renderNodesAttributes(nodes_grp)\n\n    return this\n\n  filterListItem: ($item, value) =>\n    s = $.trim($(\"a\", $item).html()).toLowerCase()\n    if s.indexOf(value) == -1\n      $item.hide()\n    else\n      $item.show()\n\n  filterList: (ul, value) =>\n    self = this\n    ul_title = ul.prev()\n    has_visible_items = false\n\n    $(\"li\", ul).each () -> self.filterListItem($(this), value)\n\n    if $(\"li:visible\", ul).length == 0\n      ul_title.hide()\n    else\n      ul_title.show()\n    return this\n\n  initSearch: () =>\n    self = this\n    $(\"#node_filter\").keyup (e) ->\n      v = $.trim($(\"#node_filter\").val()).toLowerCase()\n      if v == \"\"\n        $(\"#tab-new li, #tab-new h3\").show()\n      else\n        $(\"#tab-new ul\").each () -> self.filterList($(this), v)\n    return this\n\n  nodeClick: (e) =>\n    dir = true;\n    rel = $(e.currentTarget).attr('rel')\n    if rel == 'Direction' \n      dir = true\n    else if rel == 'NoDirection'\n      dir = false\n    @settings.direction = dir\n    @renderArrow()\n\n\n  initNewNode: () =>\n    self = this\n    $container = $(\"#tab-new\")\n    result = []\n    # nodes_by_group could be an empty object but we define\n    # inital groups to have a coherent ordering in sidebar\n    nodes_by_group =\n      Shape:[]\n      Arrow: []\n      Base: []\n      Conditional: []\n      Math: []\n      Code: []\n      Utils: []\n      Three: []\n      Geometry: []\n      Materials: []\n      Lights: []\n      PostProcessing: []\n      Spread: []\n      Particle: []\n      \"Particle-sparks\": []\n      \"Particle-sparks-initializers\": []\n      \"Particle-sparks-actions\": []\n      \"Particle-sparks-zone\": []\n      \"Constructive-Geometry\": []\n\n    # Organize each node types by group\n    for node of ThreeNodes.Core.nodes.models\n      # don't show hidden nodes types (group_name = false)\n      if ThreeNodes.Core.nodes.models[node].group_name\n        group_name = (ThreeNodes.Core.nodes.models[node].group_name).replace(/\\./g, \"-\")\n        if !nodes_by_group[group_name]\n          nodes_by_group[group_name] = []\n        nodes_by_group[group_name].push(node)\n\n    # Render the buttons and add them to the dom\n    for group of nodes_by_group\n      $container.append(\"<h3>#{group}</h3><ul id='nodetype-#{group}'></ul>\")\n      for node in nodes_by_group[group]\n        $(\"#nodetype-#{group}\", $container).append(\"<li><a class='button' rel='#{node}' href='#'>#{ ThreeNodes.Core.nodes.models[node].node_name }</a></li>\")\n\n    # Make the list of nodes draggable\n    $(\"a.button\", $container).draggable\n      revert: \"valid\"\n      opacity: 0.7\n      helper: \"clone\"\n      revertDuration: 0\n      scroll: false\n      containment: \"document\"\n    @renderArrow()  \n    $(\"#nodetype-Arrow li a\").bind('click', @nodeClick)\n    return this\n\n  renderArrow: ()=>\n    rel = '';\n    if @settings.direction\n      rel = 'Direction'\n    else\n      rel = 'NoDirection'\n    \n    $(\"#nodetype-Arrow a.button\").css\n      background: \"#313638\"\n      \n    $(\"#nodetype-Arrow a.button[rel='\" + rel + \"']\").css\n      background: '#191c1d'\n    \n\n\n\n    \n\n    \n\nmodule.exports = Sidebar\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/views/sidebar/Sidebar.coffee","#\"use strict\"\n_ = require 'Underscore'\nBackbone = require 'Backbone'\n\n#require 'threenodes/views/sidebar/fields/BoolField'\n#require 'threenodes/views/sidebar/fields/StringField'\n#require 'threenodes/views/sidebar/fields/FloatField'\n#require 'threenodes/views/sidebar/fields/Vector2Field'\n#require 'threenodes/views/sidebar/fields/Vector3Field'\n#require 'threenodes/views/sidebar/fields/Vector4Field'\n#require 'threenodes/views/sidebar/fields/QuaternionField'\n#require 'threenodes/views/sidebar/fields/EulerField'\n\n### NodeSidebarView ###\nclass NodeSidebarView extends Backbone.View\n  initialize: (options) ->\n    super\n    @render()\n\n  displayFields: (fields) =>\n    #throw new Error(\"Need to reimplement\")\n    # todo: set the View from the field class.\n    # add a static field on the model, @sidebarView: BoolFieldView\n    for f of fields\n      field = fields[f]\n      view_class = field.constructor.VIEW\n\n      if view_class != false\n        view = new view_class\n          model: field\n        @$el.append(view.el)\n\n  render: () =>\n    return\n    # Compile the template file\n    @$el.html(\"<h2>#{@model.get('name')}</h2>\")\n    @displayFields(@model.fields.inputs)\n\n    # Special case for code nodes, add buttons to add inputs/outputs.\n    # Todo: find a way to define a sidebarview class by nodetypes and\n    # refactor this (CodeSidebarView extends NodeSidebarView)\n    if @model.onCodeUpdate\n      self = this\n      @$el.append(\"<h2>Add custom fields</h2>\")\n      $inputs_form = $('<form class=\"dynamic-fields__form\"></form>')\n      $inputs_form.append('<input type=\"text\" name=\"key\" placeholder=\"key\" />')\n      $inputs_form.append('<input type=\"text\" name=\"type\" placeholder=\"type\" />')\n      $inputs_form.append('<input type=\"submit\" value=\"Add input field\" />')\n      @$el.append($inputs_form)\n\n      $inputs_form.on 'submit', (e) ->\n        e.preventDefault()\n        $form = $(this)\n        $key = $(this).find('[name=\"key\"]')\n        $type = $(this).find('[name=\"type\"]')\n        type = 'Any'\n        if $.trim($type.val()) != ''\n          type = $.trim($type.val())\n        key = $.trim($key.val())\n        if key != ''\n          # add this to the model custom fields definition and rerender the view.\n          self.model.addCustomField(key, type, 'inputs')\n          # Reset form.\n          $key.val('')\n          $type.val('')\n\n          # Simply rerender the sidebar.\n          # todo: maybe do something like remove the render.\n          self.render()\n\n    return @\n\nmodule.exports = NodeSidebarView\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/views/sidebar/NodeSidebarView.coffee","#\"use strict\"\n_ = require 'Underscore'\nBackbone = require 'Backbone'\n\nrequire 'treeJquery'\n\nclass TreeView extends Backbone.View\n  initialize: (options) ->\n    super\n    @timeoutId = false\n\n  render: (nodelist) =>\n    if @$el.data(\"tree\")\n      @$el.tree(\"destroy\")\n\n    if nodelist == false\n      @$el.html(\"\")\n      return this\n    data = []\n    terminalNodes = {}\n    for node in nodelist.models\n      if node.hasOutConnection() == false\n        terminalNodes[node.attributes[\"id\"]] = node\n\n    renderNode = (node) =>\n      result = {}\n      result.label = node.get(\"name\")\n      result.model = node\n      result.children = []\n      upstreamNodes = node.getUpstreamNodes()\n      for upnode in upstreamNodes\n        result.children.push(renderNode(upnode))\n\n      return result\n\n    for id of terminalNodes\n      data.push(renderNode(terminalNodes[id]))\n\n    @$el.tree\n      data: data\n      autoOpen: true\n      selectable: true\n\n    @$el.bind \"tree.click\", (e) =>\n      node = e.node.model\n      $( \".node\" ).removeClass(\"ui-selected\")\n      node.trigger(\"node:addSelectedClass\")\n      selectable = $(\"#container\").data(\"selectable\")\n      selectable.refresh()\n      selectable._mouseStop(null)\n    return this\n\nmodule.exports = TreeView\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/views/TreeView.coffee","#\"use strict\"\n_ = require 'Underscore'\nBackbone = require 'Backbone'\n\nclass Breadcrumb extends Backbone.View\n  initialize: () ->\n    super\n    @$el.click(@onClick)\n\n  reset: () =>\n    @items = []\n    @$el.html(\"\")\n\n  set: (items) =>\n    # items is an ordered array of groups\n    @items = items\n    @$el.html(\"<a href='#' data-gid='global'>Global</a>\")\n    for item in items\n      name = item.get(\"name\")\n      gid = item.get(\"gid\")\n      @$el.append(\" ▶ \" + \"<a href='#' class='grp' data-gid='#{gid}'>#{name}</a>\")\n\n  onClick: (e) =>\n    gid = $(e.target).data(\"gid\")\n    if gid == \"global\"\n      @trigger(\"click\", \"global\")\n\nmodule.exports = Breadcrumb\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/views/Breadcrumb.coffee","#\"use strict\"\n_ = require 'Underscore'\nBackbone = require 'Backbone'\n_view_menubar = require 'templates/app_menubar.tmpl.html'\nrequire 'jquery.menubar'\n\nclass MenuBar extends Backbone.View\n  @template: _view_menubar\n\n  initialize: () ->\n    @$el.menubar()\n\n    self = this\n    $(\"a\", @$el).click (event) ->\n      if $(this).next().is(\"ul\")\n        return false\n\n      url = $(this).attr('href').substr(1)\n      self.onLinkClick(event, this, url)\n\n    $(\"#main_file_input_open\").change (e) =>\n      @trigger(\"LoadFile\", e)\n\n  onLinkClick: (event, link, url) =>\n    data_event = $(link).data(\"event\")\n    data_attr = $(link).data(\"eventData\")\n\n    if data_event\n      #event.preventDefault()\n\n      @trigger(data_event, data_attr)\n\n      # exceptions and special event handling\n      switch data_event\n        when \"ClearWorkspace\"\n          Backbone.history.navigate(\"\", false)\n        when \"OpenFile\"\n          $(\"#main_file_input_open\").click()\n      return true\n\n    # sends \"normal\" urls to the router\n    return true\n\nmodule.exports = MenuBar\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/views/MenuBar.coffee","module.exports = \"<ul id=\\\"main-menu-bar\\\" class=\\\"menubar ui-layout-north\\\">\\n  <li>\\n    <a href=\\\"#File\\\">File</a>\\n    <ul>\\n      <li><a href=\\\"#NewFile\\\" data-event=\\\"ClearWorkspace\\\">New</a></li>\\n      <li><a href=\\\"#OpenFile\\\" data-event=\\\"OpenFile\\\">Open</a></li>\\n      <li><a href=\\\"#SaveFile\\\" data-event=\\\"SaveFile\\\">Save</a></li>\\n    </ul>\\n  </li>\\n  <li>\\n    <a href=\\\"#Edit\\\">Edit</a>\\n    <ul>\\n      <li><a href=\\\"#Rotate\\\" data-event=\\\"Rotate\\\">Rotate</a></li>\\n      <li><a href=\\\"#GroupSelectedNodes\\\" data-event=\\\"GroupSelectedNodes\\\">Group selected nodes</a></li>\\n    </ul>\\n  </li>\\n  <li>\\n    <a href=\\\"#View\\\">View</a>\\n    <ul>\\n      <li><a href=\\\"#Library\\\" data-event=\\\"ToggleLibrary\\\">Library</a></li>\\n      <li><a href=\\\"#Attributes\\\" data-event=\\\"ToggleAttributes\\\">Attributes</a></li>\\n    </ul>\\n  </li>\\n  <li class=\\\"expanded\\\">\\n    <a href=\\\"#examples\\\">Examples</a>\\n    <ul>\\n      <li><a href=\\\"#example/rotating_cube1.json\\\">Eagle Eye</a></li>\\n      <li><a href=\\\"#example/geometry_and_material1.json\\\">VVR</a></li>\\n    </ul>\\n  </li>\\n</ul>\\n\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./templates/app_menubar.tmpl.html\n// module id = 97\n// module chunks = 3","/*!\n * jQuery UI Menubar @VERSION\n * http://jqueryui.com\n *\n * Copyright 2013 jQuery Foundation and other contributors\n * Released under the MIT license.\n * http://jquery.org/license\n *\n * http://api.jqueryui.com/menubar/\n *\n * Depends:\n *  jquery.ui.core.js\n *  jquery.ui.widget.js\n *  jquery.ui.position.js\n *  jquery.ui.menu.js\n */\n(function( $ ) {\n\n$.widget( \"ui.menubar\", {\n  version: \"@VERSION\",\n  options: {\n    items: \"li\",\n    menus: \"ul\",\n    icons: {\n      dropdown: \"ui-icon-triangle-1-s\"\n    },\n    position: {\n      my: \"left top\",\n      at: \"left bottom\"\n    },\n\n    // callbacks\n    select: null\n  },\n\n  _create: function() {\n    // Top-level elements containing the submenu-triggering elem\n    this.menuItems = this.element.children( this.options.items );\n\n    // Links or buttons in menuItems, triggers of the submenus\n    this.items = this.menuItems.children( \"button, a\" );\n\n    // Keep track of open submenus\n    this.openSubmenus = 0;\n\n    this._initializeWidget();\n    this._initializeMenuItems();\n    this._initializeItems();\n  },\n\n  _initializeWidget: function() {\n    this.element\n      .addClass( \"ui-menubar ui-widget-header ui-helper-clearfix\" )\n      .attr( \"role\", \"menubar\" );\n    this._on({\n      keydown: function( event ) {\n        var active;\n\n        // If we are in a nested sub-sub-menu and we see an ESCAPE\n        // we must close recursively.\n        if ( event.keyCode === $.ui.keyCode.ESCAPE &&\n            this.active &&\n            this.active.menu( \"collapse\", event ) !== true ) {\n          active = this.active;\n          this.active.blur();\n          this._close( event );\n          $( event.target ).blur().mouseleave();\n          active.prev().focus();\n        }\n      },\n      focusin: function() {\n        clearTimeout( this.closeTimer );\n      },\n      focusout: function( event ) {\n        this.closeTimer = this._delay( function() {\n          this._close( event );\n          this.items.attr( \"tabIndex\", -1 );\n          this.lastFocused.attr( \"tabIndex\", 0 );\n        }, 150 );\n      },\n      \"mouseenter .ui-menubar-item\": function() {\n        clearTimeout( this.closeTimer );\n      }\n    } );\n  },\n\n  _initializeMenuItems: function() {\n    var subMenus,\n      menubar = this;\n\n    this.menuItems\n      .addClass( \"ui-menubar-item\" )\n      .attr( \"role\", \"presentation\" )\n      // TODO why do these not work when moved to CSS?\n      .css({\n        \"border-width\": \"1px\",\n        \"border-style\": \"hidden\"\n      });\n\n    subMenus = this.menuItems.children( menubar.options.menus ).menu({\n      position: {\n        within: this.options.position.within\n      },\n      select: function( event, ui ) {\n        // TODO don't hardcode markup selectors\n        ui.item.parents( \"ul.ui-menu:last\" ).hide();\n        menubar._close();\n        ui.item.parents( \".ui-menubar-item\" ).children().first().focus();\n        menubar._trigger( \"select\", event, ui );\n      },\n      menus: this.options.menus\n    })\n      .hide()\n      .attr({\n        \"aria-hidden\": \"true\",\n        \"aria-expanded\": \"false\"\n      });\n\n    this._on( subMenus, {\n      keydown: function( event ) {\n        // TODO why is this needed?\n        $( event.target ).attr( \"tabIndex\", 0 );\n        var parentButton,\n          menu = $( this );\n        // TODO why are there keydown events on a hidden menu?\n        if ( menu.is( \":hidden\" ) ) {\n          return;\n        }\n        switch ( event.keyCode ) {\n        case $.ui.keyCode.LEFT:\n          // TODO why can't this call menubar.previous()?\n          parentButton = menubar.active.prev( \".ui-button\" );\n\n          if ( this.openSubmenus ) {\n            this.openSubmenus--;\n          } else if ( this._hasSubMenu( parentButton.parent().prev() ) ) {\n            menubar.active.blur();\n            menubar._open( event, parentButton.parent().prev().find( \".ui-menu\" ) );\n          } else {\n            parentButton.parent().prev().find( \".ui-button\" ).focus();\n            menubar._close( event );\n            this.open = true;\n          }\n\n          event.preventDefault();\n          // TODO same as above where it's set to 0\n          $( event.target ).attr( \"tabIndex\", -1 );\n          break;\n        case $.ui.keyCode.RIGHT:\n          this.next( event );\n          event.preventDefault();\n          break;\n        }\n      },\n      focusout: function( event ) {\n        // TODO why does this have to use event.target? Is that different from currentTarget?\n        $( event.target ).removeClass( \"ui-state-focus\" );\n      }\n    });\n\n    this.menuItems.each(function( index, menuItem ) {\n      menubar._identifyMenuItemsNeighbors( $( menuItem ), menubar, index );\n    });\n\n  },\n\n  _hasSubMenu: function( menuItem ) {\n    return $( menuItem ).children( this.options.menus ).length > 0;\n  },\n\n  // TODO get rid of these - currently still in use in _move\n  _identifyMenuItemsNeighbors: function( menuItem, menubar, index ) {\n    var collectionLength = this.menuItems.length,\n      isFirstElement = ( index === 0 ),\n      isLastElement = ( index === ( collectionLength - 1 ) );\n\n    if ( isFirstElement ) {\n      menuItem.data( \"prevMenuItem\", $( this.menuItems[collectionLength - 1]) );\n      menuItem.data( \"nextMenuItem\", $( this.menuItems[index+1]) );\n    } else if ( isLastElement ) {\n      menuItem.data( \"nextMenuItem\", $( this.menuItems[0]) );\n      menuItem.data( \"prevMenuItem\", $( this.menuItems[index-1]) );\n    } else {\n      menuItem.data( \"nextMenuItem\", $( this.menuItems[index+1]) );\n      menuItem.data( \"prevMenuItem\", $( this.menuItems[index-1]) );\n    }\n  },\n\n  _initializeItems: function() {\n    var menubar = this;\n\n    this._focusable( this.items );\n    this._hoverable( this.items );\n\n    // let only the first item receive focus\n    this.items.slice(1).attr( \"tabIndex\", -1 );\n\n    this.items.each(function( index, item ) {\n      menubar._initializeItem( $( item ), menubar );\n    });\n  },\n\n  _initializeItem: function( anItem ) {\n    var menuItemHasSubMenu = this._hasSubMenu( anItem.parent() );\n\n    anItem\n      .addClass( \"ui-button ui-widget ui-button-text-only ui-menubar-link\" )\n      .attr( \"role\", \"menuitem\" )\n      .wrapInner( \"<span class='ui-button-text'></span>\" );\n\n    this._on( anItem, {\n      focus:  function( event ){\n        anItem.attr( \"tabIndex\", 0 );\n        anItem.addClass( \"ui-state-focus\" );\n        event.preventDefault();\n      },\n      focusout:  function( event ){\n        anItem.attr( \"tabIndex\", -1 );\n        this.lastFocused = anItem;\n        anItem.removeClass( \"ui-state-focus\" );\n        event.preventDefault();\n      }\n    } );\n\n    if ( menuItemHasSubMenu ) {\n      this._on( anItem, {\n        click: this._mouseBehaviorForMenuItemWithSubmenu,\n        focus: this._mouseBehaviorForMenuItemWithSubmenu,\n        mouseenter: this._mouseBehaviorForMenuItemWithSubmenu\n      });\n\n      this._on( anItem, {\n        keydown: function( event ) {\n          switch ( event.keyCode ) {\n          case $.ui.keyCode.SPACE:\n          case $.ui.keyCode.UP:\n          case $.ui.keyCode.DOWN:\n            this._open( event, $( event.target ).next() );\n            event.preventDefault();\n            break;\n          case $.ui.keyCode.LEFT:\n            this.previous( event );\n            event.preventDefault();\n            break;\n          case $.ui.keyCode.RIGHT:\n            this.next( event );\n            event.preventDefault();\n            break;\n          case $.ui.keyCode.TAB:\n            break;\n          }\n        }\n      });\n\n      anItem.attr( \"aria-haspopup\", \"true\" );\n      if ( this.options.icons ) {\n        anItem.append( \"<span class='ui-button-icon-secondary ui-icon \" + this.options.icons.dropdown + \"'></span>\" );\n        anItem.removeClass( \"ui-button-text-only\" ).addClass( \"ui-button-text-icon-secondary\" );\n      }\n    } else {\n      this._on( anItem, {\n        click: function() {\n          if ( this.active ) {\n            this._close();\n          } else {\n            this.open = true;\n            this.active = $( anItem ).parent();\n          }\n        },\n        mouseenter: function() {\n          if ( this.open ) {\n            this.stashedOpenMenu = this.active;\n            this._close();\n          }\n        },\n        keydown: function( event ) {\n          if ( event.keyCode === $.ui.keyCode.LEFT ) {\n            this.previous( event );\n            event.preventDefault();\n          } else if ( event.keyCode === $.ui.keyCode.RIGHT ) {\n            this.next( event );\n            event.preventDefault();\n          }\n        }\n      });\n    }\n  },\n\n  // TODO silly name, too much complexity\n  // TODO why is this used for three types of events?\n  _mouseBehaviorForMenuItemWithSubmenu: function( event ) {\n    var isClickingToCloseOpenMenu, menu;\n\n    // ignore triggered focus event\n    if ( event.type === \"focus\" && !event.originalEvent ) {\n      return;\n    }\n    event.preventDefault();\n\n    menu = $(event.target).parents( \".ui-menubar-item\" ).children( this.options.menus );\n\n    // If we have an open menu and we see a click on the menuItem\n    // and the menu thereunder is the same as the active menu, close it.\n    // Succinctly: toggle menu open / closed  on the menuItem\n    isClickingToCloseOpenMenu = event.type === \"click\" &&\n      menu.is( \":visible\" ) &&\n      this.active &&\n      this.active[0] === menu[0];\n\n    if ( isClickingToCloseOpenMenu ) {\n      this._close();\n      return;\n    }\n    if ( event.type === \"mouseenter\" ) {\n      this.element.find( \":focus\" ).focusout();\n      if ( this.stashedOpenMenu ) {\n        this._open( event, menu);\n      }\n      this.stashedOpenMenu = undefined;\n    }\n    // If we already opened a menu and then changed to be \"over\" another MenuItem ||\n    // we clicked on a new menuItem (whether open or not) or if we auto expand (i.e.\n    // we expand regardless of click if there is a submenu\n    if ( ( this.open && event.type === \"mouseenter\" ) || event.type === \"click\" ) {\n      clearTimeout( this.closeTimer );\n      this._open( event, menu );\n      // Stop propagation so that menuItem mouseenter doesn't fire.  If it does it\n      // takes the \"selected\" status off off of the first element of the submenu.\n      event.stopPropagation();\n    }\n  },\n\n  _destroy : function() {\n    this.menuItems\n      .removeClass( \"ui-menubar-item\" )\n      .removeAttr( \"role\" )\n      .css({\n        \"border-width\": \"\",\n        \"border-style\": \"\"\n      });\n\n    this.element\n      .removeClass( \"ui-menubar ui-widget-header ui-helper-clearfix\" )\n      .removeAttr( \"role\" )\n      .unbind( \".menubar\" );\n\n    this.items\n      .unbind( \".menubar\" )\n      .removeClass( \"ui-button ui-widget ui-button-text-only ui-menubar-link ui-state-default\" )\n      .removeAttr( \"role\" )\n      .removeAttr( \"aria-haspopup\" )\n      .children( \".ui-icon\" ).remove();\n\n    // TODO fix this\n    if ( false ) {\n      // Does not unwrap\n      this.items.children( \"span.ui-button-text\" ).unwrap();\n    } else {\n      // Does \"unwrap\"\n      this.items.children( \"span.ui-button-text\" ).each( function(){\n        var item = $( this );\n        item.parent().html( item.html() );\n      });\n    }\n\n    this.element.find( \":ui-menu\" )\n      .menu( \"destroy\" )\n      .show()\n      .removeAttr( \"aria-hidden\" )\n      .removeAttr( \"aria-expanded\" )\n      .removeAttr( \"tabindex\" )\n      .unbind( \".menubar\" );\n  },\n\n  _collapseActiveMenu: function() {\n    if ( !this.active.is( \":ui-menu\" ) ) {\n      return;\n    }\n    this.active\n      .menu( \"collapseAll\" )\n      .hide()\n      .attr({\n        \"aria-hidden\": \"true\",\n        \"aria-expanded\": \"false\"\n      })\n      .closest( this.options.items ).removeClass( \"ui-state-active\" );\n  },\n\n  _close: function() {\n    if ( !this.active ) {\n      return;\n    }\n\n    this._collapseActiveMenu();\n\n    this.active = null;\n    this.open = false;\n    this.openSubmenus = 0;\n  },\n\n  _open: function( event, menu ) {\n    var menuItem = menu.closest( \".ui-menubar-item\" );\n\n    if ( this.active && this.active.length &&\n        this._hasSubMenu( this.active.closest( this.options.items ) ) ) {\n          this._collapseActiveMenu();\n    }\n\n    menuItem.addClass( \"ui-state-active\" );\n    // workaround when clicking a non-menu item, then hovering a menu, then going back\n    // this way afterwards its still possible to tab back to a menubar, even if its\n    // the wrong item\n    // see also \"click menu-less item, hover in and out of item with menu\" test in menubar_core\n    if ( !this.lastFocused ) {\n      this.lastFocused = menu.prev();\n    }\n\n    this.active = menu\n      .show()\n      .position( $.extend({\n        of: menuItem\n      }, this.options.position ) )\n      .removeAttr( \"aria-hidden\" )\n      .attr( \"aria-expanded\", \"true\" )\n      .menu( \"focus\", event, menu.children( \".ui-menu-item\" ).first()  )\n      .focus();\n\n    this.open = true;\n  },\n\n  next: function( event ) {\n    function shouldOpenNestedSubMenu() {\n      return this.active &&\n        this._hasSubMenu( this.active.closest( this.options.items ) ) &&\n        this.active.data( \"uiMenu\" ) &&\n        this.active.data( \"uiMenu\" ).active &&\n        this.active.data( \"uiMenu\" ).active.has( \".ui-menu\" ).length;\n    }\n\n    if ( this.open ) {\n      if ( shouldOpenNestedSubMenu.call( this ) ) {\n        // Track number of open submenus and prevent moving to next menubar item\n        this.openSubmenus++;\n        return;\n      }\n    }\n    this.openSubmenus = 0;\n    this._move( \"next\", event );\n  },\n\n  previous: function( event ) {\n    if ( this.open && this.openSubmenus ) {\n      // Track number of open submenus and prevent moving to previous menubar item\n      this.openSubmenus--;\n      return;\n    }\n    this.openSubmenus = 0;\n    this._move( \"prev\", event );\n  },\n\n  _move: function( direction, event ) {\n    var closestMenuItem = $( event.target ).closest( \".ui-menubar-item\" ),\n      nextMenuItem = closestMenuItem.data( direction + \"MenuItem\" ),\n      focusableTarget = nextMenuItem.find( \".ui-button\" );\n\n    if ( this.open ) {\n      if ( this._hasSubMenu( nextMenuItem ) ) {\n        this._open( event, nextMenuItem.children( \".ui-menu\" ) );\n      } else {\n        this._collapseActiveMenu();\n        nextMenuItem.find( \".ui-button\" ).focus();\n        this.open = true;\n      }\n    } else {\n      closestMenuItem.find( \".ui-button\" );\n      focusableTarget.focus();\n    }\n  }\n\n});\n\n}( jQuery ));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./libs/jquery.menubar.js\n// module id = 98\n// module chunks = 3","/**\n * Provides requestAnimationFrame in a cross browser way.\n * http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n */\n\nif ( !window.requestAnimationFrame ) {\n\n\twindow.requestAnimationFrame = ( function() {\n\n\t\treturn window.webkitRequestAnimationFrame ||\n\t\twindow.mozRequestAnimationFrame ||\n\t\twindow.oRequestAnimationFrame ||\n\t\twindow.msRequestAnimationFrame ||\n\t\tfunction( /* function FrameRequestCallback */ callback, /* DOMElement Element */ element ) {\n\n\t\t\twindow.setTimeout( callback, 1000 / 60 );\n\n\t\t};\n\n\t} )();\n\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./libs/three-extras/js/RequestAnimationFrame.js\n// module id = 99\n// module chunks = 3","module.exports = __WEBPACK_EXTERNAL_MODULE_100__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"Raphael\"\n// module id = 100\n// module chunks = 3","/*\n * transform: A jQuery cssHooks adding cross-browser 2d transform capabilities to $.fn.css() and $.fn.animate()\n *\n * limitations:\n * - requires jQuery 1.4.3+\n * - Should you use the *translate* property, then your elements need to be absolutely positionned in a relatively positionned wrapper **or it will fail in IE678**.\n * - transformOrigin is not accessible\n *\n * latest version and complete README available on Github:\n * https://github.com/louisremi/jquery.transform.js\n *\n * Copyright 2011 @louis_remi\n * Licensed under the MIT license.\n *\n * This saved you an hour of work?\n * Send me music http://www.amazon.co.uk/wishlist/HNTU0468LQON\n *\n */\n(function( $, window, document, Math, undefined ) {\n\n/*\n * Feature tests and global variables\n */\nvar div = document.createElement(\"div\"),\n\tdivStyle = div.style,\n\tsuffix = \"Transform\",\n\ttestProperties = [\n\t\t\"O\" + suffix,\n\t\t\"ms\" + suffix,\n\t\t\"Webkit\" + suffix,\n\t\t\"Moz\" + suffix\n\t],\n\ti = testProperties.length,\n\tsupportProperty,\n\tsupportMatrixFilter,\n\tsupportFloat32Array = \"Float32Array\" in window,\n\tpropertyHook,\n\tpropertyGet,\n\trMatrix = /Matrix([^)]*)/,\n\trAffine = /^\\s*matrix\\(\\s*1\\s*,\\s*0\\s*,\\s*0\\s*,\\s*1\\s*(?:,\\s*0(?:px)?\\s*){2}\\)\\s*$/,\n\t_transform = \"transform\",\n\t_transformOrigin = \"transformOrigin\",\n\t_translate = \"translate\",\n\t_rotate = \"rotate\",\n\t_scale = \"scale\",\n\t_skew = \"skew\",\n\t_matrix = \"matrix\";\n\n// test different vendor prefixes of these properties\nwhile ( i-- ) {\n\tif ( testProperties[i] in divStyle ) {\n\t\t$.support[_transform] = supportProperty = testProperties[i];\n\t\t$.support[_transformOrigin] = supportProperty + \"Origin\";\n\t\tcontinue;\n\t}\n}\n// IE678 alternative\nif ( !supportProperty ) {\n\t$.support.matrixFilter = supportMatrixFilter = divStyle.filter === \"\";\n}\n\n// px isn't the default unit of these properties\n$.cssNumber[_transform] = $.cssNumber[_transformOrigin] = true;\n\n/*\n * fn.css() hooks\n */\nif ( supportProperty && supportProperty != _transform ) {\n\t// Modern browsers can use jQuery.cssProps as a basic hook\n\t$.cssProps[_transform] = supportProperty;\n\t$.cssProps[_transformOrigin] = supportProperty + \"Origin\";\n\n\t// Firefox needs a complete hook because it stuffs matrix with \"px\"\n\tif ( supportProperty == \"Moz\" + suffix ) {\n\t\tpropertyHook = {\n\t\t\tget: function( elem, computed ) {\n\t\t\t\treturn (computed ?\n\t\t\t\t\t// remove \"px\" from the computed matrix\n\t\t\t\t\t$.css( elem, supportProperty ).split(\"px\").join(\"\"):\n\t\t\t\t\telem.style[supportProperty]\n\t\t\t\t);\n\t\t\t},\n\t\t\tset: function( elem, value ) {\n\t\t\t\t// add \"px\" to matrices\n\t\t\t\telem.style[supportProperty] = /matrix\\([^)p]*\\)/.test(value) ?\n\t\t\t\t\tvalue.replace(/matrix((?:[^,]*,){4})([^,]*),([^)]*)/, _matrix+\"$1$2px,$3px\"):\n\t\t\t\t\tvalue;\n\t\t\t}\n\t\t};\n\t/* Fix two jQuery bugs still present in 1.5.1\n\t * - rupper is incompatible with IE9, see http://jqbug.com/8346\n\t * - jQuery.css is not really jQuery.cssProps aware, see http://jqbug.com/8402\n\t */\n\t} else if ( /^1\\.[0-5](?:\\.|$)/.test($.fn.jquery) ) {\n\t\tpropertyHook = {\n\t\t\tget: function( elem, computed ) {\n\t\t\t\treturn (computed ?\n\t\t\t\t\t$.css( elem, supportProperty.replace(/^ms/, \"Ms\") ):\n\t\t\t\t\telem.style[supportProperty]\n\t\t\t\t);\n\t\t\t}\n\t\t};\n\t}\n\t/* TODO: leverage hardware acceleration of 3d transform in Webkit only\n\telse if ( supportProperty == \"Webkit\" + suffix && support3dTransform ) {\n\t\tpropertyHook = {\n\t\t\tset: function( elem, value ) {\n\t\t\t\telem.style[supportProperty] =\n\t\t\t\t\tvalue.replace();\n\t\t\t}\n\t\t}\n\t}*/\n\n} else if ( supportMatrixFilter ) {\n\tpropertyHook = {\n\t\tget: function( elem, computed, asArray ) {\n\t\t\tvar elemStyle = ( computed && elem.currentStyle ? elem.currentStyle : elem.style ),\n\t\t\t\tmatrix, data;\n\n\t\t\tif ( elemStyle && rMatrix.test( elemStyle.filter ) ) {\n\t\t\t\tmatrix = RegExp.$1.split(\",\");\n\t\t\t\tmatrix = [\n\t\t\t\t\tmatrix[0].split(\"=\")[1],\n\t\t\t\t\tmatrix[2].split(\"=\")[1],\n\t\t\t\t\tmatrix[1].split(\"=\")[1],\n\t\t\t\t\tmatrix[3].split(\"=\")[1]\n\t\t\t\t];\n\t\t\t} else {\n\t\t\t\tmatrix = [1,0,0,1];\n\t\t\t}\n\n\t\t\tif ( ! $.cssHooks[_transformOrigin] ) {\n\t\t\t\tmatrix[4] = elemStyle ? parseInt(elemStyle.left, 10) || 0 : 0;\n\t\t\t\tmatrix[5] = elemStyle ? parseInt(elemStyle.top, 10) || 0 : 0;\n\n\t\t\t} else {\n\t\t\t\tdata = $._data( elem, \"transformTranslate\", undefined );\n\t\t\t\tmatrix[4] = data ? data[0] : 0;\n\t\t\t\tmatrix[5] = data ? data[1] : 0;\n\t\t\t}\n\n\t\t\treturn asArray ? matrix : _matrix+\"(\" + matrix + \")\";\n\t\t},\n\t\tset: function( elem, value, animate ) {\n\t\t\tvar elemStyle = elem.style,\n\t\t\t\tcurrentStyle,\n\t\t\t\tMatrix,\n\t\t\t\tfilter,\n\t\t\t\tcenterOrigin;\n\n\t\t\tif ( !animate ) {\n\t\t\t\telemStyle.zoom = 1;\n\t\t\t}\n\n\t\t\tvalue = matrix(value);\n\n\t\t\t// rotate, scale and skew\n\t\t\tMatrix = [\n\t\t\t\t\"Matrix(\"+\n\t\t\t\t\t\"M11=\"+value[0],\n\t\t\t\t\t\"M12=\"+value[2],\n\t\t\t\t\t\"M21=\"+value[1],\n\t\t\t\t\t\"M22=\"+value[3],\n\t\t\t\t\t\"SizingMethod='auto expand'\"\n\t\t\t].join();\n\t\t\tfilter = ( currentStyle = elem.currentStyle ) && currentStyle.filter || elemStyle.filter || \"\";\n\n\t\t\telemStyle.filter = rMatrix.test(filter) ?\n\t\t\t\tfilter.replace(rMatrix, Matrix) :\n\t\t\t\tfilter + \" progid:DXImageTransform.Microsoft.\" + Matrix + \")\";\n\n\t\t\tif ( ! $.cssHooks[_transformOrigin] ) {\n\n\t\t\t\t// center the transform origin, from pbakaus's Transformie http://github.com/pbakaus/transformie\n\t\t\t\tif ( (centerOrigin = $.transform.centerOrigin) ) {\n\t\t\t\t\telemStyle[centerOrigin == \"margin\" ? \"marginLeft\" : \"left\"] = -(elem.offsetWidth/2) + (elem.clientWidth/2) + \"px\";\n\t\t\t\t\telemStyle[centerOrigin == \"margin\" ? \"marginTop\" : \"top\"] = -(elem.offsetHeight/2) + (elem.clientHeight/2) + \"px\";\n\t\t\t\t}\n\n\t\t\t\t// translate\n\t\t\t\t// We assume that the elements are absolute positionned inside a relative positionned wrapper\n\t\t\t\telemStyle.left = value[4] + \"px\";\n\t\t\t\telemStyle.top = value[5] + \"px\";\n\n\t\t\t} else {\n\t\t\t\t$.cssHooks[_transformOrigin].set( elem, value );\n\t\t\t}\n\t\t}\n\t};\n}\n// populate jQuery.cssHooks with the appropriate hook if necessary\nif ( propertyHook ) {\n\t$.cssHooks[_transform] = propertyHook;\n}\n// we need a unique setter for the animation logic\npropertyGet = propertyHook && propertyHook.get || $.css;\n\n/*\n * fn.animate() hooks\n */\n$.fx.step.transform = function( fx ) {\n\tvar elem = fx.elem,\n\t\tstart = fx.start,\n\t\tend = fx.end,\n\t\tpos = fx.pos,\n\t\ttransform = \"\",\n\t\tprecision = 1E5,\n\t\ti, startVal, endVal, unit;\n\n\t// fx.end and fx.start need to be converted to interpolation lists\n\tif ( !start || typeof start === \"string\" ) {\n\n\t\t// the following block can be commented out with jQuery 1.5.1+, see #7912\n\t\tif ( !start ) {\n\t\t\tstart = propertyGet( elem, supportProperty );\n\t\t}\n\n\t\t// force layout only once per animation\n\t\tif ( supportMatrixFilter ) {\n\t\t\telem.style.zoom = 1;\n\t\t}\n\n\t\t// replace \"+=\" in relative animations (-= is meaningless with transforms)\n\t\tend = end.split(\"+=\").join(start);\n\n\t\t// parse both transform to generate interpolation list of same length\n\t\t$.extend( fx, interpolationList( start, end ) );\n\t\tstart = fx.start;\n\t\tend = fx.end;\n\t}\n\n\ti = start.length;\n\n\t// interpolate functions of the list one by one\n\twhile ( i-- ) {\n\t\tstartVal = start[i];\n\t\tendVal = end[i];\n\t\tunit = +false;\n\n\t\tswitch ( startVal[0] ) {\n\n\t\t\tcase _translate:\n\t\t\t\tunit = \"px\";\n\t\t\tcase _scale:\n\t\t\t\tunit || ( unit = \"\");\n\n\t\t\t\ttransform = startVal[0] + \"(\" +\n\t\t\t\t\tMath.round( (startVal[1][0] + (endVal[1][0] - startVal[1][0]) * pos) * precision ) / precision + unit +\",\"+\n\t\t\t\t\tMath.round( (startVal[1][1] + (endVal[1][1] - startVal[1][1]) * pos) * precision ) / precision + unit + \")\"+\n\t\t\t\t\ttransform;\n\t\t\t\tbreak;\n\n\t\t\tcase _skew + \"X\":\n\t\t\tcase _skew + \"Y\":\n\t\t\tcase _rotate:\n\t\t\t\ttransform = startVal[0] + \"(\" +\n\t\t\t\t\tMath.round( (startVal[1] + (endVal[1] - startVal[1]) * pos) * precision ) / precision +\"rad)\"+\n\t\t\t\t\ttransform;\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tfx.origin && ( transform = fx.origin + transform );\n\n\tpropertyHook && propertyHook.set ?\n\t\tpropertyHook.set( elem, transform, +true ):\n\t\telem.style[supportProperty] = transform;\n};\n\n/*\n * Utility functions\n */\n\n// turns a transform string into its \"matrix(A,B,C,D,X,Y)\" form (as an array, though)\nfunction matrix( transform ) {\n\ttransform = transform.split(\")\");\n\tvar\n\t\t\ttrim = $.trim\n\t\t, i = -1\n\t\t// last element of the array is an empty string, get rid of it\n\t\t, l = transform.length -1\n\t\t, split, prop, val\n\t\t, prev = supportFloat32Array ? new Float32Array(6) : []\n\t\t, curr = supportFloat32Array ? new Float32Array(6) : []\n\t\t, rslt = supportFloat32Array ? new Float32Array(6) : [1,0,0,1,0,0]\n\t\t;\n\n\tprev[0] = prev[3] = rslt[0] = rslt[3] = 1;\n\tprev[1] = prev[2] = prev[4] = prev[5] = 0;\n\n\t// Loop through the transform properties, parse and multiply them\n\twhile ( ++i < l ) {\n\t\tsplit = transform[i].split(\"(\");\n\t\tprop = trim(split[0]);\n\t\tval = split[1];\n\t\tcurr[0] = curr[3] = 1;\n\t\tcurr[1] = curr[2] = curr[4] = curr[5] = 0;\n\n\t\tswitch (prop) {\n\t\t\tcase _translate+\"X\":\n\t\t\t\tcurr[4] = parseInt(val, 10);\n\t\t\t\tbreak;\n\n\t\t\tcase _translate+\"Y\":\n\t\t\t\tcurr[5] = parseInt(val, 10);\n\t\t\t\tbreak;\n\n\t\t\tcase _translate:\n\t\t\t\tval = val.split(\",\");\n\t\t\t\tcurr[4] = parseInt(val[0], 10);\n\t\t\t\tcurr[5] = parseInt(val[1] || 0, 10);\n\t\t\t\tbreak;\n\n\t\t\tcase _rotate:\n\t\t\t\tval = toRadian(val);\n\t\t\t\tcurr[0] = Math.cos(val);\n\t\t\t\tcurr[1] = Math.sin(val);\n\t\t\t\tcurr[2] = -Math.sin(val);\n\t\t\t\tcurr[3] = Math.cos(val);\n\t\t\t\tbreak;\n\n\t\t\tcase _scale+\"X\":\n\t\t\t\tcurr[0] = +val;\n\t\t\t\tbreak;\n\n\t\t\tcase _scale+\"Y\":\n\t\t\t\tcurr[3] = val;\n\t\t\t\tbreak;\n\n\t\t\tcase _scale:\n\t\t\t\tval = val.split(\",\");\n\t\t\t\tcurr[0] = val[0];\n\t\t\t\tcurr[3] = val.length>1 ? val[1] : val[0];\n\t\t\t\tbreak;\n\n\t\t\tcase _skew+\"X\":\n\t\t\t\tcurr[2] = Math.tan(toRadian(val));\n\t\t\t\tbreak;\n\n\t\t\tcase _skew+\"Y\":\n\t\t\t\tcurr[1] = Math.tan(toRadian(val));\n\t\t\t\tbreak;\n\n\t\t\tcase _matrix:\n\t\t\t\tval = val.split(\",\");\n\t\t\t\tcurr[0] = val[0];\n\t\t\t\tcurr[1] = val[1];\n\t\t\t\tcurr[2] = val[2];\n\t\t\t\tcurr[3] = val[3];\n\t\t\t\tcurr[4] = parseInt(val[4], 10);\n\t\t\t\tcurr[5] = parseInt(val[5], 10);\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// Matrix product (array in column-major order)\n\t\trslt[0] = prev[0] * curr[0] + prev[2] * curr[1];\n\t\trslt[1] = prev[1] * curr[0] + prev[3] * curr[1];\n\t\trslt[2] = prev[0] * curr[2] + prev[2] * curr[3];\n\t\trslt[3] = prev[1] * curr[2] + prev[3] * curr[3];\n\t\trslt[4] = prev[0] * curr[4] + prev[2] * curr[5] + prev[4];\n\t\trslt[5] = prev[1] * curr[4] + prev[3] * curr[5] + prev[5];\n\n\t\tprev = [rslt[0],rslt[1],rslt[2],rslt[3],rslt[4],rslt[5]];\n\t}\n\treturn rslt;\n}\n\n// turns a matrix into its rotate, scale and skew components\n// algorithm from http://hg.mozilla.org/mozilla-central/file/7cb3e9795d04/layout/style/nsStyleAnimation.cpp\nfunction unmatrix(matrix) {\n\tvar\n\t\t\tscaleX\n\t\t, scaleY\n\t\t, skew\n\t\t, A = matrix[0]\n\t\t, B = matrix[1]\n\t\t, C = matrix[2]\n\t\t, D = matrix[3]\n\t\t;\n\n\t// Make sure matrix is not singular\n\tif ( A * D - B * C ) {\n\t\t// step (3)\n\t\tscaleX = Math.sqrt( A * A + B * B );\n\t\tA /= scaleX;\n\t\tB /= scaleX;\n\t\t// step (4)\n\t\tskew = A * C + B * D;\n\t\tC -= A * skew;\n\t\tD -= B * skew;\n\t\t// step (5)\n\t\tscaleY = Math.sqrt( C * C + D * D );\n\t\tC /= scaleY;\n\t\tD /= scaleY;\n\t\tskew /= scaleY;\n\t\t// step (6)\n\t\tif ( A * D < B * C ) {\n\t\t\tA = -A;\n\t\t\tB = -B;\n\t\t\tskew = -skew;\n\t\t\tscaleX = -scaleX;\n\t\t}\n\n\t// matrix is singular and cannot be interpolated\n\t} else {\n\t\t// In this case the elem shouldn't be rendered, hence scale == 0\n\t\tscaleX = scaleY = skew = 0;\n\t}\n\n\t// The recomposition order is very important\n\t// see http://hg.mozilla.org/mozilla-central/file/7cb3e9795d04/layout/style/nsStyleAnimation.cpp#l971\n\treturn [\n\t\t[_translate, [+matrix[4], +matrix[5]]],\n\t\t[_rotate, Math.atan2(B, A)],\n\t\t[_skew + \"X\", Math.atan(skew)],\n\t\t[_scale, [scaleX, scaleY]]\n\t];\n}\n\n// build the list of transform functions to interpolate\n// use the algorithm described at http://dev.w3.org/csswg/css3-2d-transforms/#animation\nfunction interpolationList( start, end ) {\n\tvar list = {\n\t\t\tstart: [],\n\t\t\tend: []\n\t\t},\n\t\ti = -1, l,\n\t\tcurrStart, currEnd, currType;\n\n\t// get rid of affine transform matrix\n\t( start == \"none\" || isAffine( start ) ) && ( start = \"\" );\n\t( end == \"none\" || isAffine( end ) ) && ( end = \"\" );\n\n\t// if end starts with the current computed style, this is a relative animation\n\t// store computed style as the origin, remove it from start and end\n\tif ( start && end && !end.indexOf(\"matrix\") && toArray( start ).join() == toArray( end.split(\")\")[0] ).join() ) {\n\t\tlist.origin = start;\n\t\tstart = \"\";\n\t\tend = end.slice( end.indexOf(\")\") +1 );\n\t}\n\n\tif ( !start && !end ) { return; }\n\n\t// start or end are affine, or list of transform functions are identical\n\t// => functions will be interpolated individually\n\tif ( !start || !end || functionList(start) == functionList(end) ) {\n\n\t\tstart && ( start = start.split(\")\") ) && ( l = start.length );\n\t\tend && ( end = end.split(\")\") ) && ( l = end.length );\n\n\t\twhile ( ++i < l-1 ) {\n\t\t\tstart[i] && ( currStart = start[i].split(\"(\") );\n\t\t\tend[i] && ( currEnd = end[i].split(\"(\") );\n\t\t\tcurrType = $.trim( ( currStart || currEnd )[0] );\n\n\t\t\tappend( list.start, parseFunction( currType, currStart ? currStart[1] : 0 ) );\n\t\t\tappend( list.end, parseFunction( currType, currEnd ? currEnd[1] : 0 ) );\n\t\t}\n\n\t// otherwise, functions will be composed to a single matrix\n\t} else {\n\t\tlist.start = unmatrix(matrix(start));\n\t\tlist.end = unmatrix(matrix(end))\n\t}\n\n\treturn list;\n}\n\nfunction parseFunction( type, value ) {\n\tvar\n\t\t// default value is 1 for scale, 0 otherwise\n\t\tdefaultValue = +(!type.indexOf(_scale)),\n\t\tscaleX,\n\t\t// remove X/Y from scaleX/Y & translateX/Y, not from skew\n\t\tcat = type.replace( /e[XY]/, \"e\" );\n\n\tswitch ( type ) {\n\t\tcase _translate+\"Y\":\n\t\tcase _scale+\"Y\":\n\n\t\t\tvalue = [\n\t\t\t\tdefaultValue,\n\t\t\t\tvalue ?\n\t\t\t\t\tparseFloat( value ):\n\t\t\t\t\tdefaultValue\n\t\t\t];\n\t\t\tbreak;\n\n\t\tcase _translate+\"X\":\n\t\tcase _translate:\n\t\tcase _scale+\"X\":\n\t\t\tscaleX = 1;\n\t\tcase _scale:\n\n\t\t\tvalue = value ?\n\t\t\t\t( value = value.split(\",\") ) &&\t[\n\t\t\t\t\tparseFloat( value[0] ),\n\t\t\t\t\tparseFloat( value.length>1 ? value[1] : type == _scale ? scaleX || value[0] : defaultValue+\"\" )\n\t\t\t\t]:\n\t\t\t\t[defaultValue, defaultValue];\n\t\t\tbreak;\n\n\t\tcase _skew+\"X\":\n\t\tcase _skew+\"Y\":\n\t\tcase _rotate:\n\t\t\tvalue = value ? toRadian( value ) : 0;\n\t\t\tbreak;\n\n\t\tcase _matrix:\n\t\t\treturn unmatrix( value ? toArray(value) : [1,0,0,1,0,0] );\n\t\t\tbreak;\n\t}\n\n\treturn [[ cat, value ]];\n}\n\nfunction isAffine( matrix ) {\n\treturn rAffine.test(matrix);\n}\n\nfunction functionList( transform ) {\n\treturn transform.replace(/(?:\\([^)]*\\))|\\s/g, \"\");\n}\n\nfunction append( arr1, arr2, value ) {\n\twhile ( value = arr2.shift() ) {\n\t\tarr1.push( value );\n\t}\n}\n\n// converts an angle string in any unit to a radian Float\nfunction toRadian(value) {\n\treturn ~value.indexOf(\"deg\") ?\n\t\tparseInt(value,10) * (Math.PI * 2 / 360):\n\t\t~value.indexOf(\"grad\") ?\n\t\t\tparseInt(value,10) * (Math.PI/200):\n\t\t\tparseFloat(value);\n}\n\n// Converts \"matrix(A,B,C,D,X,Y)\" to [A,B,C,D,X,Y]\nfunction toArray(matrix) {\n\t// remove the unit of X and Y for Firefox\n\tmatrix = /([^,]*),([^,]*),([^,]*),([^,]*),([^,p]*)(?:px)?,([^)p]*)(?:px)?/.exec(matrix);\n\treturn [matrix[1], matrix[2], matrix[3], matrix[4], matrix[5], matrix[6]];\n}\n\n$.transform = {\n\tcenterOrigin: \"margin\"\n};\n\n})( jQuery, window, document, Math );\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./libs/jquery.transform2d.js\n// module id = 101\n// module chunks = 3","/**\n * ScrollView - jQuery plugin 0.1\n *\n * This plugin supplies contents view by grab and drag scroll.\n *\n * Copyright (c) 2009 Toshimitsu Takahashi\n *\n * Released under the MIT license.\n *\n * == Usage =======================\n *   // apply to block element.\n *   $(\"#map\").scrollview();\n *   \n *   // with setting grab and drag icon urls.\n *   //   grab: the cursor when mouse button is up.\n *   //   grabbing: the cursor when mouse button is down.\n *   //\n *   $(\"#map\".scrollview({\n *     grab : \"images/openhand.cur\",\n *     grabbing : \"images/closedhand.cur\"\n *   });\n * ================================\n */\n(function() {\n    function ScrollView(){ this.initialize.apply(this, arguments) }\n    ScrollView.prototype = {\n        initialize: function(container, config){\n                // setting cursor.\n                var gecko = navigator.userAgent.indexOf(\"Gecko/\") != -1;\n                var opera = navigator.userAgent.indexOf(\"Opera/\") != -1;\n                var mac = navigator.userAgent.indexOf(\"Mac OS\") != -1;\n                if (opera) {\n                    this.grab = \"default\";\n                    this.grabbing = \"move\";\n                } else if (!(mac && gecko) && config) {\n                    if (config.grab) {\n                       this.grab = \"url(\\\"\" + config.grab + \"\\\"),default\";\n                    }\n                    if (config.grabbing) {\n                       this.grabbing = \"url(\" + config.grabbing + \"),move\";\n                    }\n                } else if (gecko) {\n                    this.grab = \"-moz-grab\";\n                    this.grabbing = \"-moz-grabbing\";\n                } else {\n                    this.grab = \"default\";\n                    this.grabbing = \"move\";\n                }\n                \n                // Get container and image.\n                this.m = $(container);\n                this.i = this.m.children().css(\"cursor\", this.grab);\n                \n                this.isgrabbing = false;\n                \n                // Set mouse events.\n                var self = this;\n                this.i.mousedown(function(e){\n                  // todo: make the first condition an option and submit a patch when it's done\n                        if (e.target != $(\"svg\", $(container))[0]) {\n                          return false;\n                        }\n                        self.startgrab();\n                        this.xp = e.pageX;\n                        this.yp = e.pageY;\n                        return false;\n                }).mousemove(function(e){\n                        if (!self.isgrabbing) return true;\n                        self.scrollTo(this.xp - e.pageX, this.yp - e.pageY);\n                        this.xp = e.pageX;\n                        this.yp = e.pageY;\n                        return false;\n                })\n                .mouseout(function(){ self.stopgrab() })\n                .mouseup(function(){ self.stopgrab() });\n                \n                this.centering();\n        },\n        centering: function(){\n                var _m = this.m;\n                var w = this.i.width() - _m.width();\n                var h = this.i.height() - _m.height();\n                _m.scrollLeft(w / 2).scrollTop(h / 2);\n        },\n        startgrab: function(){\n                this.isgrabbing = true;\n                this.i.css(\"cursor\", this.grabbing);\n        },\n        stopgrab: function(){\n                this.isgrabbing = false;\n                this.i.css(\"cursor\", this.grab);\n        },\n        scrollTo: function(dx, dy){\n                var _m = this.m;\n                var x = _m.scrollLeft() + dx;\n                var y = _m.scrollTop() + dy;\n                _m.scrollLeft(x).scrollTop(y);\n        }\n    };\n    \n    jQuery.fn.scrollview = function(config){\n        return this.each(function(){\n            new ScrollView(this, config);\n        });\n    };\n})(jQuery);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./libs/jquery-scrollview/jquery.scrollview.js\n// module id = 102\n// module chunks = 3","#\"use strict\"\n_ = require 'Underscore'\nBackbone = require 'Backbone'\nConnectionView = require 'threenodes/connections/views/ConnectionView'\nGroupView = require 'threenodes/groups/views/Group'\nrequire 'jquery.ui'\n\n\n### Workspace View ###\n\n# A workspace consists of nodes and connections.\n# There is a global workspace and possibly many workspaces\n# from group nodes. There is always only one workspace displayed.\n\nclass Workspace extends Backbone.View\n  initialize: (options) =>\n    super\n    @settings = options.settings\n    @initDrop()\n\n    @views = []\n    @nodes = core.nodes\n    @connections = core.connections\n    @groups = core.groups\n\n    @nodes.bind(\"add\", @renderNode)\n    @connections.bind(\"add\", @renderConnection)\n    @groups.bind(\"add\", @renderGroup)\n\n  render: () =>\n    \n    \n\n  destroy: () =>\n    # Remove all existing views before displaying new ones\n    _.each(@views, (view) -> view.remove())\n    @nodes.unbind(\"add\", @renderNode)\n    @connections.unbind(\"add\", @renderConnection)\n    delete @views\n    delete @settings\n    @remove()\n\n  renderNode: (node) =>\n    nodename = node.constructor.name\n\n    if ThreeNodes.Core.nodes.views[nodename]\n      # If there is a view associated with the node model use it\n      viewclass = ThreeNodes.Core.nodes.views[nodename]\n    else\n      # Use the default view class\n      viewclass = ThreeNodes.Core.nodes.views.NodeView\n\n    # Add directly the node element to the dom so that the view can\n    # access the .parent() directly. (@see FieldsView.onFieldCreated)\n    $nodeEl = $(\"<div class='node'></div>\").appendTo(@$el)\n    view = new viewclass\n      model: node\n      el: $nodeEl\n\n    # Save the id and model in the data attribute\n    view.$el.data(\"id\", node.get(\"id\"))\n    view.$el.data(\"object\", node)\n    @views.push(view)\n\n  renderConnection: (connection) =>\n    if @settings.test == true\n      return false\n    view = new ConnectionView\n      model: connection\n      settings: @settings\n    @views.push(view)\n\n  renderGroup: (group) =>\n    $groupEl = $(\"<div class='group'></div>\").appendTo(@$el)\n    view  = new GroupView\n      model: group\n      el: $groupEl\n\n    @views.push(view)\n    view.$el.data(\"object\", group)\n\n\n\n\n\n  initDrop: () =>\n    self = this\n    # Setup the drop area for the draggables created above\n    $(\"#container\").droppable\n      accept: \"#tab-new a.button, #library .definition\"\n      activeClass: \"ui-state-active\"\n      hoverClass: \"ui-state-hover\"\n      drop: (event, ui) ->\n        offset = $(\"#container-wrapper\").offset()\n        definition = false\n\n        if ui.draggable.hasClass(\"definition\")\n          nodename = \"Group\"\n          container =  $(\"#library\")\n          definition = ui.draggable.data(\"model\")\n          offset.left -= container.offset().left\n        else\n          nodename = ui.draggable.attr(\"rel\")\n          container =  $(\"#sidebar .ui-layout-center\")\n\n        dx = ui.position.left + $(\"#container-wrapper\").scrollLeft() - offset.left - 10\n        dy = ui.position.top + $(\"#container-wrapper\").scrollTop() - container.scrollTop() - offset.top\n        if self.nodes\n          self.nodes.createNode({type: nodename, x: dx, y: dy, definition: definition})\n        $(\"#sidebar\").show()\n\n    return this\n\nmodule.exports = Workspace\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/views/Workspace.coffee","_ = require 'Underscore'\nBackbone = require 'Backbone'\n\nrequire 'jquery.ui'\n\n### Connection View ###\nclass ConnectionView extends Backbone.View\n  initialize: () ->\n    super\n    @container = $(\"#graph\")\n    \n    # @svg = ThreeNodes.UI.UIView.svg.path().attr\n    #   stroke: \"#555\"\n    #   fill: \"none\"\n    @svg = ThreeNodes.UI.UIView.svg;\n    @curve = @svg.path().attr\n      stroke: \"#fff\"\n    @triangle = @svg.path().attr\n      stroke: \"#fff\"\n      fill: \"#fff\"\n\n    # set the dom element\n    @el = @svg.node\n    @model.bind(\"render\", () => @render())\n    @model.bind(\"destroy\", () => @remove())\n    @model.bind(\"remove\", () => @remove())\n    @render()\n\n  remove: ->\n    if(@curve)\n      @curve.remove()\n      delete @curve\n    \n    if(@triangle)\n      @triangle.remove()\n      delete @triangle\n\n    return true\n\n  render: () ->\n    #                 node  group nodeInsideGroup\n    # node            n->n  n->g  n->g\n    # group           g->n  g->g  g->g\n    # nodeInsideGroup g->n  g->g  sameGroup ? not render: g->g\n    if(@model.from.id == @model.to.id)\n      @remove()\n      return\n\n    drawModel = @model\n    fromGroup = core.groups.getByNodeId(@model.from.id)\n    toGroup = core.groups.getByNodeId(@model.to.id)\n    if(fromGroup && toGroup && fromGroup.id == toGroup.id)\n      @remove()\n      return\n    \n    drawModel = {\n      from: fromGroup || @model.from\n      fromType: @model.fromType\n      to: toGroup || @model.to\n      toType: @model.toType\n    }\n\n    if @svg \n      @renderCurve(drawModel);\n      @renderTriangle();\n    @\n\n  getNodePosition: (model, type) ->\n    x = model.get('x')\n    y = model.get('y')\n\n    width = model.get('width')\n    height = model.get('height')\n\n    switch type\n      when 'left' then o1 = {left: x, top: y + height/2}\n      when 'right' then o1 = {left: x + width, top: y + height/2}\n      when 'up' then o1 = {left: x + width/2, top: y}\n      when 'down' then o1 = {left: x + width/2, top: y + height}\n    diff = 3\n    o1.top += diff\n    o1.left += diff\n    return o1\n\n  renderTriangle: ()->\n    return;\n    len = @curve.getTotalLength()\n    obj = @curve.getPointAtLength(len-13)\n    @triangle.attr\n      path: [\"M\", 0, 0, \"L\", 1.732, -1, \"L\", 1.732, 1].join(',')\n    .transform('t' + obj.x + ',' + obj.y + 's5, 5' + 'r' + obj.alpha)\n\n  renderCurve: (drawModel) ->\n    f1 = @getNodePosition(drawModel.from, drawModel.fromType)\n    f2 = @getNodePosition(drawModel.to, drawModel.toType)\n\n    offset = $(\"#container-wrapper\").offset()\n    ofx = $(\"#container-wrapper\").scrollLeft() - offset.left\n    ofy = $(\"#container-wrapper\").scrollTop() - offset.top\n\n    x1 = f1.left\n    y1 = f1.top\n    x4 = f2.left\n    y4 = f2.top\n\n    min_diff = 42\n    diffx = Math.max(min_diff, x4 - x1)\n    diffy = Math.max(min_diff, y4 - y1)\n    x2 = x1 + diffx * 0.5\n    y2 = y1\n    x3 = x4 - diffx * 0.5\n    y3 = y4\n    @curve.attr\n      path: [\"M\", x1.toFixed(3), y1.toFixed(3), \"C\", x2, y2, x3, y3, x4.toFixed(3), y4.toFixed(3)].join(\",\")\n\nmodule.exports = ConnectionView\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/connections/views/ConnectionView.coffee","_ = require 'Underscore'\nBackbone = require 'Backbone'\nnamespace = require('libs/namespace').namespace\n\n_view_group_template = require '../templates/group.tmpl.html'\n_view_group_context_menu = require '../templates/group_context_menu.tmpl.html'\n\nrequire 'libs/jquery.contextMenu'\nrequire 'jquery.ui'\n\n### Node View ###\nclass Group extends Backbone.View\n  className: \"group\"\n\n  initialize: (model) ->\n    @makeElement()\n    @render()\n    @initContextMenus()\n    @makeDraggable()\n\n\n    @initNodeClick()\n    @initTitleClick()\n\n    # @model.on('change', @render)\n    @model.on('remove', () => @remove())\n    # @model.on(\"node:computePosition\", @computeNodePosition)\n    # @model.on(\"node:addSelectedClass\", @addSelectedClass)\n\n\n  makeElement: () =>\n    # Compile the template file\n    @template = _.template(_view_group_template, @model)\n    @$el.html(@template)\n\n    # Add the node group name as a class to the node element for easier styling\n    @$el.addClass(\"type-group\")\n\n    # Add other dynamic classes\n    @$el.addClass(\"node-Group\")\n    @addHandlerListener()\n\n\n  \n\n\n\n\n\n  initContextMenus: () =>\n    self = @\n    if $(\"#node-context-menu\").length < 1\n      node_menu = _.template(_view_node_context_menu, {})\n      $(\"body\").append(node_menu)\n    @$el.find(\".head\").contextMenu {menu: \"node-context-menu\"}, (action, el, pos) =>\n      if action == \"remove_node\" then self.model.remove()\n    return @\n\n\n\n  render: () =>\n    @$el.css\n      left: parseInt @model.get(\"x\")\n      top: parseInt @model.get(\"y\")\n    @$el.find(\"> .head span\").text(@model.get(\"name\"))\n    @$el.find(\"> .head span\").show()\n\n  computeNodePosition: () =>\n    pos = $(@el).position()\n    offset = $(\"#container-wrapper\").offset()\n    @model.set\n      x: pos.left + $(\"#container-wrapper\").scrollLeft()\n      y: pos.top + $(\"#container-wrapper\").scrollTop()\n    \n\n\n\n\n\n\n\n\n  addHandlerListener: ()->\n    self = this\n    start_offset_x = 0\n    start_offset_y = 0\n    getPath = (start, end, offset) ->\n      ofx = $(\"#container-wrapper\").scrollLeft()\n      ofy = $(\"#container-wrapper\").scrollTop()\n      \"M#{start.left + offset.left + 2} #{start.top + offset.top + 2} L#{end.left + offset.left + ofx - start_offset_x} #{end.top + offset.top + ofy - start_offset_y}\"\n\n    $('.handler', @$el).draggable\n      helper: () ->\n        $(\"<div class='ui-widget-drag-helper'></div>\")\n      scroll: true\n      cursor: 'pointer'\n      cursorAt:\n        left: 0\n        top: 0\n      start: (event, ui) ->\n        start_offset_x = $(\"#container-wrapper\").scrollLeft()\n        start_offset_y = $(\"#container-wrapper\").scrollTop()\n        # highlight_possible_targets()\n        if ThreeNodes.UI.UIView.connecting_line then ThreeNodes.UI.UIView.connecting_line.attr({opacity: 1})\n      stop: (event, ui) ->\n        # $(\".field\").removeClass \"field-possible-target\"\n        if ThreeNodes.UI.UIView.connecting_line then ThreeNodes.UI.UIView.connecting_line.attr({opacity: 0})\n      drag: (event, ui) ->\n        if ThreeNodes.UI.UIView.connecting_line\n          pos = $(this).position()\n          node_pos =\n            left: self.model.get(\"x\")\n            top: self.model.get(\"y\")\n          ThreeNodes.UI.UIView.connecting_line.attr\n            path: getPath(pos, ui.position, node_pos)\n          return true\n\n    $(\".handler\", @$el).droppable\n      accept: '.handler'\n      activeClass: \"ui-state-active\"\n      hoverClass: \"ui-state-hover\"\n      tolerance: \"pointer\"\n      drop: (event, ui) ->\n        from_node = $(ui.draggable).parent().data('object') \n        from_type = $(ui.draggable).attr('data-attr')\n\n        to_node = self.model\n        to_type = $(@).attr('data-attr')\n        \n\n        self.model.trigger(\"connection:create\", {\n          from: $(ui.draggable).parent().data('object').id \n          fromType: $(ui.draggable).attr('data-attr')\n          to: self.model.id\n          toType: $(@).attr('data-attr')\n        })\n        return this\n \n  addSelectedClass: () =>\n    @$el.addClass(\"ui-selected\")\n\n  \n\n\n\n  remove: () =>\n    $(\".field\", this.el).destroyContextMenu()\n    if @$el.data(\"draggable\") then @$el.draggable(\"destroy\")\n    $(this.el).unbind()\n    @undelegateEvents()\n    super\n\n  initNodeClick: () ->\n    self = this\n    $(@el).click (e) ->\n      if e.metaKey == false\n        $( \".group\" ).removeClass(\"ui-selected\")\n        $( \".node\" ).removeClass(\"ui-selected\")\n        $(this).addClass(\"ui-selecting\")\n      else\n        if $(this).hasClass(\"ui-selected\")\n          $(this).removeClass(\"ui-selected\")\n        else\n          $(this).addClass(\"ui-selecting\")\n      selectable = $(\"#container\").data(\"ui-selectable\")\n      if !selectable then return\n      selectable.refresh()\n      # selectable._mouseStop(null)\n      # self.model.fields.renderSidebar()\n    return @\n\n  initTitleClick: () ->\n    self = this\n\n    $title_span = @$el.find(\"> .head span\")\n    $input = $(\"<input type='text' />\")\n    @$el.find(\"> .head\").append($input)\n    $input.hide()\n\n    # Fix conflict with contextmenu.\n    $input.on 'mousedown', (e) ->\n      e.stopPropagation()\n\n    $title_span.dblclick (e) ->\n      prev = $(this).html()\n      $input.val(prev)\n      $title_span.hide();\n      $input.show()\n\n      apply_input_result = () ->\n        self.model.set('name', $input.val())\n        $input.hide()\n        $title_span.show()\n\n      $input.blur (e) ->\n        apply_input_result()\n\n      $(\"#graph\").click (e) ->\n        apply_input_result()\n\n      $input.keydown (e) ->\n        # on enter\n        if e.keyCode == 13\n          apply_input_result()\n    return @\n\n  makeDraggable: () =>\n    self = this\n\n    nodes_offset = {top: 0, left: 0}\n    selected_nodes = $([])\n\n    $(this.el).draggable\n      start: (ev, ui) ->\n        if $(this).hasClass(\"ui-selected\")\n          selected_nodes = $(\".ui-selected\").each () ->\n            $(this).data(\"offset\", $(this).offset())\n        else\n          selected_nodes = $([])\n          $(\".node\").removeClass(\"ui-selected\")\n        nodes_offset = $(this).offset()\n      drag: (ev, ui) ->\n        dt = ui.position.top - nodes_offset.top\n        dl = ui.position.left - nodes_offset.left\n        selected_nodes.not(this).each () ->\n          el = $(this)\n          offset = el.data(\"offset\")\n          dx = offset.top + dt\n          dy = offset.left + dl\n          el.css\n            top: dx\n            left: dy\n          el.data(\"object\").trigger(\"node:computePosition\")\n        self.computeNodePosition()\n        self.model.trigger('node:renderConnections', self.model)\n      stop: () ->\n        # selected_nodes.not(this).each () ->\n        #   el = $(this).data(\"object\")\n        #   el.trigger(\"node:renderConnections\")\n        # self.computeNodePosition()\n        # self.renderConnections()\n    return @\n\nmodule.exports = Group\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/groups/views/Group.coffee","module.exports = \"<ul id=\\\"group-context-menu\\\" class=\\\"context-menu\\\">\\n  <li><a href=\\\"#remove_group\\\">Remove group</a></li>\\n  <li><a href=\\\"#view_detail\\\">View detail</a></li>\\n</ul>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./threenodes/groups/templates/group_context_menu.tmpl.html\n// module id = 107\n// module chunks = 3","#\"use strict\"\n_ = require 'Underscore'\nBackbone = require 'Backbone'\n\n#require 'timeline'\n#require 'timeline-gui'\n\n### Timeline View ###\nclass AppTimeline extends Backbone.View\n  initialize: (options) =>\n    super\n    # reset canvas height\n    localStorage[\"timeline.js.settings.canvasHeight\"] = @$el.innerHeight()\n\n    @$el.html(\"\")\n    self = this\n\n    @timeline = new Timeline\n      element: @el\n      displayOnlySelected: true\n      colorBackground: \"#313638\"\n      colorButtonBackground: \"#313638\"\n      colorButtonStroke: \"#aeb7bb\"\n      colorScrollbar: \"#313638\"\n      colorScrollbarThumb: \"#656c6f\"\n      colorTimelineLabel: \"#999\"\n      colorTimelineTick: \"#656c6f\"\n      colorTimeScale: \"#666\"\n      colorHeaderBorder: \"#313638\"\n      colorTimeTicker: \"#f00\"\n      colorTrackBottomLine: \"#555\"\n      colorPropertyLabel: \"#999\"\n      onGuiSave: () =>\n        self.trigger \"OnUIResize\"\n      setPropertyValue: (propertyAnim, t) ->\n        propertyAnim.target[propertyAnim.propertyName].setValue(t)\n      applyPropertyValue: (propertyAnim, t) ->\n        propertyAnim.target[propertyAnim.propertyName].setValue(propertyAnim.startValue + (propertyAnim.endValue - propertyAnim.startValue) * t)\n      getPropertyValue: (propertyAnim) ->\n        val = propertyAnim.target[propertyAnim.propertyName].attributes[\"value\"]\n        if $.type(val) != \"array\"\n          return val\n        else\n          return val[0]\n      onTrackRebuild: () => @trigger(\"trackRebuild\")\n      onStop: () => @trigger(\"stopSound\")\n      onPlay: (time) => @trigger(\"startSound\", time)\n\n    Timeline.globalInstance = @timeline\n\n    @timeline.loop(-1)\n    @time = 0\n\n    if options.ui\n      @ui = options.ui\n      @ui.on(\"render\", @update)\n      @ui.on(\"selectAnims\", @selectAnims)\n      @ui.on(\"timelineResize\", @resize)\n\n    @trigger(\"OnUIResize\")\n\n  selectAnims: (nodes) =>\n    if @timeline\n      @timeline.selectAnims(nodes)\n\n  onNodeRemove: (node) =>\n    @selectAnims([])\n\n  remove: () =>\n    @undelegateEvents()\n\n    if @ui\n      @ui.off(\"render\", @update)\n      @ui.off(\"selectAnims\", @selectAnims)\n      @ui.off(\"timelineResize\", @resize)\n      delete @ui\n\n    @timeline.destroy()\n    delete @timeline\n    @time = null\n    # we don't want to remove the el since it is used by jquery-template\n    # that's why we will not call super there\n    #super\n\n  resize: (height) =>\n    if @timeline\n      @timeline.canvasHeight = height\n      @timeline.tracksScrollY = 0\n      @timeline.tracksScrollThumbPos = 0\n      @timeline.save()\n\n  update: () =>\n    n = Date.now()\n    if @timeline\n      dt = n - @time\n      @timeline.update(dt / 1000)\n    @time = n\n\nmodule.exports = AppTimeline\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/views/AppTimeline.coffee","#\"use strict\"\nBackbone = require 'Backbone'\n\nclass UrlHandler extends Backbone.Router\n  routes:\n    \"\": \"onDefault\"\n    \"play\": \"onPlay\"\n    \"example/:file\": \"onExample\"\n    \"play/example/:file\": \"onPlayExample\"\n\n  onDefault: () =>\n    @trigger(\"SetDisplayModeCommand\", false)\n\n  onPlay: () =>\n    @trigger(\"SetDisplayModeCommand\", true)\n\n  onExample: (file, player_mode = false) =>\n    self = this\n    @trigger(\"SetDisplayModeCommand\", player_mode)\n    @trigger(\"ClearWorkspace\")\n    $.ajax\n      url: \"examples/#{file}\"\n      dataType: 'text'\n      success: (data) ->\n        self.trigger(\"LoadJSON\", data)\n\n  onPlayExample: (file) =>\n    @onExample(file, true)\n\nmodule.exports = UrlHandler\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/utils/UrlHandler.coffee","_ = require 'Underscore'\nBackbone = require 'Backbone'\nUtils = require 'threenodes/utils/Utils'\nCodeExporter = require 'threenodes/utils/CodeExporter'\n\n\nrequire 'Blob'\nrequire 'FileSaver'\n#require 'libs/json2'\n\nclass FileHandler extends Backbone.Events\n  constructor: (@core) ->\n    _.extend(FileHandler::, Backbone.Events)\n\n  saveLocalFile: () =>\n    result_string = @getLocalJson()\n    blob = new Blob([result_string], {\"text/plain;charset=utf-8\"})\n    fileSaver = saveAs(blob, \"nodes.json\")\n\n  exportCode: () =>\n    # get the json export and convert it to code\n    json = @getLocalJson(false)\n    exporter = new CodeExporter()\n    res = exporter.toCode(json)\n\n    blob = new Blob([res], {\"text/plain;charset=utf-8\"})\n    fileSaver = saveAs(blob, \"nodes.js\")\n\n  getLocalJson: (stringify = true) =>\n    res =\n      id: @core.id\n      nodes: jQuery.map(@core.nodes.models, (n, i) -> n.toJSON())\n      connections: jQuery.map(@core.connections.models, (c, i) -> c.toJSON())\n      groups: jQuery.map(@core.groups.models, (g, i) -> g.toJSON())\n\n    if stringify\n      return JSON.stringify(res, null, 2)\n    else\n      return res\n\n  loadFromJsonData: (txt) =>\n    # Parse the json string\n    loaded_data = JSON.parse(txt)\n    @core.setNodes(loaded_data)\n\n  loadLocalFile: (e) =>\n    # Clear the workspace first\n    @trigger(\"ClearWorkspace\")\n\n    # Load the file\n    file = e.target.files[0]\n    reader = new FileReader()\n    self = this\n    reader.onload = (e) ->\n      txt = e.target.result\n      # Call loadFromJsonData when the file is loaded\n      self.loadFromJsonData(txt)\n    reader.readAsText(file, \"UTF-8\")\n\nmodule.exports = FileHandler\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/utils/FileHandler.coffee","_ = require 'Underscore'\nBackbone = require 'Backbone'\n\nclass CodeExporter\n  toCode: (json) =>\n    res = \"//\\n\"\n    res += \"// code exported from ThreeNodes.js (github.com/idflood/ThreeNodes.js)\\n\"\n    res += \"//\\n\\n\"\n    res += \"require.config({paths: {jQuery: 'loaders/jquery-loader',Underscore: 'loaders/Underscore-loader',Backbone: 'loaders/backbone-loader'}});\"\n    res += \"require(['threenodes/App', 'libs/jquery-1.6.4.min', 'libs/Underscore-min', 'libs/backbone'], function(App) {\"\n    res += \"\\n\\n\"\n    res += '\"use strict\";\\n'\n    res += \"var app = new App();\\n\"\n    res += \"var nodes = app.nodes;\\n\\n\"\n    res += \"//\\n\"\n    res += \"// nodes\\n\"\n    res += \"//\\n\"\n\n    for node in json.nodes\n      res += @nodeToCode(node)\n\n    res += \"\\n\"\n    res += \"//\\n\"\n    res += \"// connections\\n\"\n    res += \"//\\n\\n\"\n\n    for connection in json.connections\n      res += @connectionToCode(connection)\n\n    res += \"\\n\\n\"\n    res += \"// set player mode\\n\"\n    res += \"app.setDisplayMode('SetDisplayModeCommand', true);\\n\"\n    res += \"});\"\n    return res\n\n  nodeToCode: (node) =>\n    anim_to_code = (anims) ->\n      res = \"{\\n\"\n      for propName of anims\n        res += \"\\t\\t\" + \"'#{propName}' : [\\n\"\n        for anim in anims[propName]\n          res += \"\\t\\t\\t\" + \"{time: #{anim.time}, value: #{anim.value}, easing: '#{anim.easing}'},\\n\"\n        res += \"\\t\\t\" + \"],\\n\"\n      res += \"\\t}\"\n      return res\n\n    fields_to_code = (fields) ->\n      res = \"{'in': [\\n\"\n      for field in fields.in\n        if field.val\n          res += \"\\t\\t{name: '#{field.name}', val: #{field.val}},\\n\"\n        else\n          res += \"\\t\\t{name: '#{field.name}'},\\n\"\n      res += \"\\t]}\"\n      res\n\n    res = \"\\n// node: #{node.name}\\n\"\n    res += \"var node_#{node.id}_data = {\\n\"\n    res += \"\\t\" + \"id: #{node.id},\\n\"\n    res += \"\\t\" + \"name: '#{node.name}',\\n\"\n    res += \"\\t\" + \"type: '#{node.type}',\\n\"\n    res += \"\\t\" + \"x: #{node.x},\\n\"\n    res += \"\\t\" + \"y: #{node.y},\\n\"\n    res += \"\\t\" + \"fields: #{fields_to_code(node.fields)},\\n\"\n    res += \"\\t\" + \"anim: #{anim_to_code(node.anim)}\\n\"\n    res += \"};\\n\"\n    res += \"var node_#{node.id} = nodes.createNode(node_#{node.id}_data);\\n\"\n    return res\n\n  connectionToCode: (connection) ->\n    res = \"var connection_#{connection.id}_data = {\\n\"\n    res += \"\\t\" + \"id: #{connection.id},\\n\"\n    res += \"\\t\" + \"from_node: #{connection.from_node}, from: '#{connection.from}',\\n\"\n    res += \"\\t\" + \"to_node: #{connection.to_node}, to: '#{connection.to}'\\n\"\n    res += \"};\\n\"\n    res += \"var connection_#{connection.id} = nodes.createConnectionFromObject(connection_#{connection.id}_data);\\n\"\n    res\n\nmodule.exports = CodeExporter\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/utils/CodeExporter.coffee","_ = require 'Underscore'\nBackbone = require 'Backbone'\n\nrequire '../models/Node'\nNodeView = require './NodeView'\n\nclass WebGLRenderer extends NodeView\n  initialize: (options) =>\n    super\n    @preview_mode = true\n    @creating_popup = false\n    @win = false\n    @old_bg = false\n\n    $(\"body\").append(\"<div id='webgl-window'></div>\")\n    @webgl_container = $(\"#webgl-window\")\n\n    @apply_size()\n    @apply_bg_color()\n    @add_mouse_handler()\n\n    @model.on(\"on_compute\", @update)\n\n    @webgl_container.bind \"click\", (e) =>\n      if @model.settings.player_mode == false\n        @create_popup_view()\n    #@update()\n\n  update: () =>\n    # help fix asynchronous bug with firefox when opening popup\n    if @creating_popup == true && !@win\n      return\n\n    @creating_popup = false\n    if !@model.settings.test\n      @add_renderer_to_dom()\n\n    @apply_size()\n    @apply_bg_color()\n\n  remove: () =>\n    if @win && @win != false\n      @win.close()\n\n    @webgl_container.unbind()\n    @webgl_container.remove()\n\n    delete @webgl_container\n    delete @win\n    super\n\n  add_mouse_handler: =>\n    $(@model.ob.domElement).unbind(\"mousemove\")\n    $(@model.ob.domElement).bind \"mousemove\", (e) ->\n      ThreeNodes.renderer.mouseX = e.clientX\n      ThreeNodes.renderer.mouseY = e.clientY\n    return this\n\n  create_popup_view: =>\n    @preview_mode = false\n    @creating_popup = true\n\n    w = @model.fields.getField('width').getValue()\n    h = @model.fields.getField('height').getValue()\n\n    @win = window.open('', 'win' + @model.id, \"width=#{w},height=#{h},scrollbars=false,location=false,status=false,menubar=false\")\n    $(\"body\", $(@win.document)).append( @model.ob.domElement )\n    $(\"*\", $(@win.document)).css\n      padding: 0\n      margin: 0\n\n    @win.onbeforeunload = () =>\n      @preview_mode = true\n      @win.onbeforeunload = false\n      @win = false\n      @webgl_container.append( @model.ob.domElement )\n      @apply_bg_color(true)\n      @apply_size(true)\n      return\n\n    @apply_bg_color(true)\n    @apply_size(true)\n    @add_mouse_handler()\n    return this\n\n  create_preview_view: =>\n    @preview_mode = true\n    @webgl_container.append( @model.ob.domElement )\n    @apply_bg_color(true)\n    @apply_size(true)\n    @add_mouse_handler()\n    return this\n\n  add_renderer_to_dom: =>\n    if @preview_mode && $(\"canvas\", @webgl_container).length == 0\n      @create_preview_view()\n    if @preview_mode == false && @win == false\n      @create_popup_view()\n    return this\n\n  apply_bg_color: (force_refresh = false) ->\n    new_val = @model.fields.getField('bg_color').getValue().getStyle()\n\n    if @old_bg == new_val && force_refresh == false\n      return false\n\n    @model.ob.setClearColor( @model.fields.getField('bg_color').getValue(), 1 )\n    @webgl_container.css\n      background: new_val\n\n    if @win\n      $(@win.document.body).css\n        background: new_val\n\n    @old_bg = new_val\n\n  apply_size: (force_refresh = false) =>\n    w = @model.fields.getField('width').getValue()\n    h = @model.fields.getField('height').getValue()\n    dw = w\n    dh = h\n\n    if @win == false && @model.settings.player_mode == false\n      maxw = 220\n      r = w / h\n      dw = maxw\n      dh = dw / r\n    if dw != @model.width || dh != @model.height || force_refresh\n      @model.ob.setSize(dw, dh)\n\n      if @win && @win != false\n        @win.resizeTo(dw, dh + 52)\n\n    @model.width = dw\n    @model.height = dh\n\nThreeNodes.Core.addNodeView('WebGLRenderer', WebGLRenderer)\n\nmodule.exports = WebGLRenderer\n\n\n\n// WEBPACK FOOTER //\n// ./threenodes/nodes/views/WebGLRenderer.coffee"],"sourceRoot":""}